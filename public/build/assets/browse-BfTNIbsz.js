import{u as H,r as d,j as e,H as V,a as f}from"./app-AYk_vs9E.js";import{A as z}from"./app-layout-D8Tf8JSL.js";import{B as o}from"./button-DttS-hSO.js";import{C as O}from"./card-DfQq8xjq.js";import{B as r}from"./badge-CZj20M3O.js";import{I as G}from"./input-KN5y_tmq.js";import{f as a}from"./utils-DawFQoOT.js";import{D as C,b,c as k,d as A,e as D,f as P}from"./dialog-BIHROgrG.js";import{t as u}from"./index-BSCeWBGl.js";import{S}from"./shield-SUW6F_AQ.js";import{c as J}from"./createLucideIcon-B8-QgQ2g.js";import{C as I}from"./clock-CxdxAD4G.js";import{A as M}from"./arrow-right-C-4AL-GL.js";/* empty css            */import"./breadcrumb-B0lOsGUr.js";import"./sheet-BQ7ZHeJH.js";import"./index-D2xyTu0-.js";import"./index-C6YWzjxw.js";import"./index-DVPqwmDN.js";import"./index-BS1oCJ0R.js";import"./index-DH27nmtP.js";import"./index-DB97fau_.js";import"./index-JB8FLK9q.js";import"./x-C_zQvMCL.js";import"./index-KBPR2gxA.js";import"./index-D-MPqe8D.js";import"./index-g_lpINMr.js";import"./dropdown-menu-C44z3VEl.js";import"./index-DpFxWXhO.js";import"./index-kZDZBK9R.js";import"./check-o4IyhQhV.js";import"./file-text-DJz8nwxt.js";import"./users-DqaIzH7r.js";import"./package-famJlHsI.js";import"./wallet-1YY19SXz.js";import"./chevron-down-DjDlq31K.js";import"./skeleton-C1cSm2kL.js";import"./use-effective-tenant-it7FmrhR.js";import"./use-tenant-router-yHxY6vf2.js";import"./trash-2-CBlWZpKk.js";import"./en-US-DSSwd-Ay.js";import"./endOfMonth-BNqLjwTF.js";import"./user-C3DA-HUB.js";import"./dollar-sign-CtwrfOoy.js";import"./credit-card-BBEokihX.js";import"./mail-DQFl-2hO.js";import"./circle-alert-DSmqB_aB.js";import"./building-2-ClZdYFLS.js";import"./chevron-right-BFzkFd6A.js";import"./sonner-B0HlpBLA.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],L=J("Percent",Q),U=[{title:"Loan Packages",href:"/loan-packages"},{title:"Browse Packages",href:"/loan-packages/browse"}],R=n=>{switch(n){case"low":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},q=n=>{switch(n){case"simple":return"bg-blue-100 text-blue-800";case"compound":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}};function Je({loanPackages:n,user:l,loanSettings:K}){var N,v;const{tenant:Y}=H().props,[s,m]=d.useState(null),[j,p]=d.useState(!1),[x,c]=d.useState(""),[B,h]=d.useState(!1),y=n.filter(t=>t.is_active),g=y.filter(t=>t.is_featured),E=y.filter(t=>!t.is_featured),F=t=>{const i=t.target.value.replace(/[^0-9]/g,"");if(i===""){c("");return}const w=parseInt(i,10);isNaN(w)||c(w.toLocaleString())},T=async()=>{if(!s)return;if(!K.allow_loans_without_kyc&&!l.kyc_verified_at){h(!0);return}const t=parseInt(x.replace(/,/g,""),10);if(isNaN(t)){u.error("Please enter a valid loan amount");return}if(t<s.min_amount||t>s.max_amount){u.error(`Amount must be between ${a(s.min_amount,s.currency.code)} and ${a(s.max_amount,s.currency.code)}`);return}p(!0);try{f.post(route("user-loans.store",{tenant:Y}),{package_id:s.id,amount:t,duration_days:s.min_duration_days,currency_id:s.currency.id,interest_rate:s.interest_rate,interest_type:s.interest_type,interest_calculation:s.interest_calculation,interest_payment_frequency:s.interest_payment_frequency,purpose:"Loan package activation",status:"pending"},{onSuccess:()=>{u.success("Loan package activated successfully"),m(null),c("")},onError:i=>{u.error("Failed to activate loan package"),console.error(i)},onFinish:()=>{p(!1)}})}catch(i){console.error("Error activating loan package:",i),p(!1)}},$=()=>{var t;((t=l.kyc_verification)==null?void 0:t.status)==="pending"?f.visit(route("kyc.show")):f.visit(route("kyc.create"))},_=({pkg:t})=>e.jsxs(O,{className:"overflow-hidden",children:[e.jsx("div",{className:"h-2 w-full",style:{backgroundColor:t.color_code||"#3b82f6"}}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:t.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.code})]}),e.jsx(r,{variant:"secondary",className:"capitalize",children:t.user_type})]}),e.jsx("p",{className:"text-muted-foreground line-clamp-2",children:t.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Amount Range"}),e.jsxs("p",{className:"font-medium",children:[a(t.min_amount,t.currency.code)," - ",a(t.max_amount,t.currency.code)]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Duration"}),e.jsxs("p",{className:"font-medium",children:[t.min_duration_days," - ",t.max_duration_days," days"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(r,{className:R(t.risk_level),children:[e.jsx(S,{className:"mr-1 h-3 w-3"}),t.risk_level," Risk"]}),e.jsxs(r,{className:q(t.interest_type),children:[e.jsx(L,{className:"mr-1 h-3 w-3"}),t.interest_type," Interest"]}),e.jsxs(r,{variant:"outline",children:[e.jsx(I,{className:"mr-1 h-3 w-3"}),t.interest_payment_frequency.replace("_"," ")]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs(o,{className:"w-full",onClick:()=>m(t),children:["View Details",e.jsx(M,{className:"ml-2 h-4 w-4"})]})})]})]},t.id);return e.jsxs(z,{breadcrumbs:U,children:[e.jsx(V,{title:"Browse Loan Packages"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-4",children:[g.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Featured Packages"}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:g.map(t=>e.jsx(_,{pkg:t},t.id))})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Available Packages"}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:E.map(t=>e.jsx(_,{pkg:t},t.id))})]}),e.jsx(C,{open:!!s,onOpenChange:()=>{m(null),c("")},children:e.jsxs(b,{className:"max-w-2xl",children:[e.jsxs(k,{children:[e.jsx(A,{children:s==null?void 0:s.name}),e.jsx(D,{children:s==null?void 0:s.code})]}),s&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Package Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Type:"})," ",s.user_type]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Amount Range:"})," ",a(s.min_amount,s.currency.code)," - ",a(s.max_amount,s.currency.code)]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Duration:"})," ",s.min_duration_days," - ",s.max_duration_days," days"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Interest Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Rate:"})," ",s.interest_rate,"%"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Type:"})," ",s.interest_type]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Calculation:"})," ",s.interest_calculation]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Payment Frequency:"})," ",s.interest_payment_frequency.replace("_"," ")]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Description"}),e.jsx("p",{className:"text-muted-foreground",children:s.description})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(r,{className:R(s.risk_level),children:[e.jsx(S,{className:"mr-1 h-3 w-3"}),s.risk_level," Risk"]}),e.jsxs(r,{className:q(s.interest_type),children:[e.jsx(L,{className:"mr-1 h-3 w-3"}),s.interest_type," Interest"]}),e.jsxs(r,{variant:"outline",children:[e.jsx(I,{className:"mr-1 h-3 w-3"}),s.interest_payment_frequency.replace("_"," ")]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"loanAmount",className:"text-sm font-medium",children:["Enter Loan Amount (",s.currency.code,")"]}),e.jsx(G,{id:"loanAmount",type:"text",value:x,onChange:F,placeholder:`Enter amount between ${a(s.min_amount,s.currency.code)} and ${a(s.max_amount,s.currency.code)}`,className:"text-right"})]}),e.jsxs(P,{children:[e.jsx(o,{variant:"outline",onClick:()=>{m(null),c("")},children:"Cancel"}),e.jsx(o,{onClick:T,disabled:j||!x,children:j?"Activating...":"Activate Package"})]})]})]})}),e.jsx(C,{open:B,onOpenChange:h,children:e.jsxs(b,{children:[e.jsxs(k,{children:[e.jsx(A,{children:"KYC Verification Required"}),e.jsx(D,{children:((N=l.kyc_verification)==null?void 0:N.status)==="pending"?"Your KYC verification is currently pending review. Please check your KYC status.":"You need to complete your KYC verification before you can activate a loan package. This is required to ensure the security and compliance of our platform."})]}),e.jsxs(P,{children:[e.jsx(o,{variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(o,{onClick:$,children:((v=l.kyc_verification)==null?void 0:v.status)==="pending"?"Check KYC Status":"Complete KYC"})]})]})})]})]})}export{Je as default};
