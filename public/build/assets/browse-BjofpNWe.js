import{b as H,r as d,j as e,H as V,a as f}from"./app--rPLb1Wa.js";import{A as z}from"./app-layout-Dnm4xl_Y.js";import{B as o}from"./button-t6oEvNNW.js";import{C as O}from"./card-CKITB03R.js";import{B as r}from"./badge-BytQ6YWm.js";import{I as G}from"./input-7hAbn_4K.js";import{f as a}from"./utils-DawFQoOT.js";import{D as b,b as C,c as k,d as A,e as D,f as P}from"./dialog-eYr-eMtF.js";import{t as u}from"./index-Dtar63yJ.js";import{S}from"./shield-DsM99oQg.js";import{c as J}from"./createLucideIcon-Dn2ECoQ0.js";import{C as I}from"./clock-CtTZSA1b.js";import{A as M}from"./arrow-right-acPTjxNE.js";/* empty css            */import"./breadcrumb-D_vSgZGN.js";import"./sheet-CrDhwUie.js";import"./index-CMqQocSw.js";import"./index-DdBBGQ2H.js";import"./index-BizbyHS1.js";import"./index-OBDDV7SX.js";import"./index-CiYhb_ol.js";import"./index-9nGA-rDe.js";import"./index-DBn22uq1.js";import"./x-5C1CNzet.js";import"./index-BNkycKvd.js";import"./index-B-ffABjE.js";import"./index-Y54OWJqv.js";import"./dropdown-menu-tGwdyT5s.js";import"./index-D1BNpUEz.js";import"./index-DKlkJ5f8.js";import"./check-B7WA0u7K.js";import"./chevron-down-3TE5sHwq.js";import"./skeleton-nucNN7DL.js";import"./use-effective-tenant-BheL7R1D.js";import"./use-tenant-router-CdkPTyQ-.js";import"./trash-2-CM4e-Rdn.js";import"./en-US-DSSwd-Ay.js";import"./endOfMonth-BNqLjwTF.js";import"./user-CAE3BrTq.js";import"./file-text-BV3sSqH6.js";import"./dollar-sign-iov7TVxI.js";import"./credit-card-D0dMZS3_.js";import"./mail-C4499bmE.js";import"./circle-alert-Bw4CcRkw.js";import"./package-DpMKRVkn.js";import"./users-DAp9UJ3w.js";import"./wallet-Idy0EFA4.js";import"./building-2-CZ3Ztb_0.js";import"./chevron-right-aR-LqB9c.js";import"./sonner-BeKZnWl-.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],L=J("Percent",Q),U=[{title:"Loan Packages",href:"/loan-packages"},{title:"Browse Packages",href:"/loan-packages/browse"}],R=n=>{switch(n){case"low":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},q=n=>{switch(n){case"simple":return"bg-blue-100 text-blue-800";case"compound":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}};function Je({loanPackages:n,user:l,loanSettings:K}){var N,v;const{tenant:Y}=H().props,[s,m]=d.useState(null),[j,p]=d.useState(!1),[x,c]=d.useState(""),[B,h]=d.useState(!1),y=n.filter(t=>t.is_active),g=y.filter(t=>t.is_featured),E=y.filter(t=>!t.is_featured),F=t=>{const i=t.target.value.replace(/[^0-9]/g,"");if(i===""){c("");return}const w=parseInt(i,10);isNaN(w)||c(w.toLocaleString())},T=async()=>{if(!s)return;if(!K.allow_loans_without_kyc&&!l.kyc_verified_at){h(!0);return}const t=parseInt(x.replace(/,/g,""),10);if(isNaN(t)){u.error("Please enter a valid loan amount");return}if(t<s.min_amount||t>s.max_amount){u.error(`Amount must be between ${a(s.min_amount,s.currency.code)} and ${a(s.max_amount,s.currency.code)}`);return}p(!0);try{f.post(route("user-loans.store",{tenant:Y}),{package_id:s.id,amount:t,duration_days:s.min_duration_days,currency_id:s.currency.id,interest_rate:s.interest_rate,interest_type:s.interest_type,interest_calculation:s.interest_calculation,interest_payment_frequency:s.interest_payment_frequency,purpose:"Loan package activation",status:"pending"},{onSuccess:()=>{u.success("Loan package activated successfully"),m(null),c("")},onError:i=>{u.error("Failed to activate loan package"),console.error(i)},onFinish:()=>{p(!1)}})}catch(i){console.error("Error activating loan package:",i),p(!1)}},$=()=>{var t;((t=l.kyc_verification)==null?void 0:t.status)==="pending"?f.visit(route("kyc.show")):f.visit(route("kyc.create"))},_=({pkg:t})=>e.jsxs(O,{className:"overflow-hidden",children:[e.jsx("div",{className:"h-2 w-full",style:{backgroundColor:t.color_code||"#3b82f6"}}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold",children:t.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.code})]}),e.jsx(r,{variant:"secondary",className:"capitalize",children:t.user_type})]}),e.jsx("p",{className:"text-muted-foreground line-clamp-2",children:t.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Amount Range"}),e.jsxs("p",{className:"font-medium",children:[a(t.min_amount,t.currency.code)," - ",a(t.max_amount,t.currency.code)]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Duration"}),e.jsxs("p",{className:"font-medium",children:[t.min_duration_days," - ",t.max_duration_days," days"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(r,{className:R(t.risk_level),children:[e.jsx(S,{className:"mr-1 h-3 w-3"}),t.risk_level," Risk"]}),e.jsxs(r,{className:q(t.interest_type),children:[e.jsx(L,{className:"mr-1 h-3 w-3"}),t.interest_type," Interest"]}),e.jsxs(r,{variant:"outline",children:[e.jsx(I,{className:"mr-1 h-3 w-3"}),t.interest_payment_frequency.replace("_"," ")]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs(o,{className:"w-full",onClick:()=>m(t),children:["View Details",e.jsx(M,{className:"ml-2 h-4 w-4"})]})})]})]},t.id);return e.jsxs(z,{breadcrumbs:U,children:[e.jsx(V,{title:"Browse Loan Packages"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-4",children:[g.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Featured Packages"}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:g.map(t=>e.jsx(_,{pkg:t},t.id))})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Available Packages"}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:E.map(t=>e.jsx(_,{pkg:t},t.id))})]}),e.jsx(b,{open:!!s,onOpenChange:()=>{m(null),c("")},children:e.jsxs(C,{className:"max-w-2xl",children:[e.jsxs(k,{children:[e.jsx(A,{children:s==null?void 0:s.name}),e.jsx(D,{children:s==null?void 0:s.code})]}),s&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Package Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Type:"})," ",s.user_type]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Amount Range:"})," ",a(s.min_amount,s.currency.code)," - ",a(s.max_amount,s.currency.code)]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Duration:"})," ",s.min_duration_days," - ",s.max_duration_days," days"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Interest Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Rate:"})," ",s.interest_rate,"%"]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Type:"})," ",s.interest_type]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Calculation:"})," ",s.interest_calculation]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Payment Frequency:"})," ",s.interest_payment_frequency.replace("_"," ")]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Description"}),e.jsx("p",{className:"text-muted-foreground",children:s.description})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(r,{className:R(s.risk_level),children:[e.jsx(S,{className:"mr-1 h-3 w-3"}),s.risk_level," Risk"]}),e.jsxs(r,{className:q(s.interest_type),children:[e.jsx(L,{className:"mr-1 h-3 w-3"}),s.interest_type," Interest"]}),e.jsxs(r,{variant:"outline",children:[e.jsx(I,{className:"mr-1 h-3 w-3"}),s.interest_payment_frequency.replace("_"," ")]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"loanAmount",className:"text-sm font-medium",children:["Enter Loan Amount (",s.currency.code,")"]}),e.jsx(G,{id:"loanAmount",type:"text",value:x,onChange:F,placeholder:`Enter amount between ${a(s.min_amount,s.currency.code)} and ${a(s.max_amount,s.currency.code)}`,className:"text-right"})]}),e.jsxs(P,{children:[e.jsx(o,{variant:"outline",onClick:()=>{m(null),c("")},children:"Cancel"}),e.jsx(o,{onClick:T,disabled:j||!x,children:j?"Activating...":"Activate Package"})]})]})]})}),e.jsx(b,{open:B,onOpenChange:h,children:e.jsxs(C,{children:[e.jsxs(k,{children:[e.jsx(A,{children:"KYC Verification Required"}),e.jsx(D,{children:((N=l.kyc_verification)==null?void 0:N.status)==="pending"?"Your KYC verification is currently pending review. Please check your KYC status.":"You need to complete your KYC verification before you can activate a loan package. This is required to ensure the security and compliance of our platform."})]}),e.jsxs(P,{children:[e.jsx(o,{variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(o,{onClick:$,children:((v=l.kyc_verification)==null?void 0:v.status)==="pending"?"Check KYC Status":"Complete KYC"})]})]})})]})]})}export{Je as default};
