import{r as k,u as I,j as e,H as T,L as C}from"./app-DU4M08QO.js";import{A as O}from"./app-layout-CWJDu2yd.js";import{B as o}from"./button-0DWS1uOF.js";import{C as f,a as g,b as j,c as y}from"./card-CIVp5v17.js";import{I as N}from"./input-z-FCfDx3.js";import{L as c}from"./label-BsVN1GsZ.js";import{u as U}from"./use-tenant-router-mhkU5Kgb.js";import{A as Y}from"./arrow-left-CFh-5xCY.js";import{C as J}from"./calendar-WI8NWamZ.js";import{c as S}from"./createLucideIcon-Kjqtfux8.js";import{U as G}from"./users-Cd4kg-Sk.js";import{S as K}from"./square-check-big-C4DYcEpB.js";import{D as Q}from"./dollar-sign-DzSGN3WH.js";/* empty css            */import"./breadcrumb-BSvnjDea.js";import"./utils-DawFQoOT.js";import"./sheet-CHL5JyIf.js";import"./index-ksG8cN4f.js";import"./index-Ba8EDFfi.js";import"./index-DWOVOz5G.js";import"./index-BfArzEZR.js";import"./index-Dax8b012.js";import"./index-BuAmfKhH.js";import"./index-DVV6TkzN.js";import"./x-DVBtjuUJ.js";import"./index-CY-eh05M.js";import"./index-DdLmsglv.js";import"./index-Dy8zP7tC.js";import"./dropdown-menu-BSZHQ9yV.js";import"./index-C31rQuzh.js";import"./index-ELRl1PxQ.js";import"./check-CljcYcVc.js";import"./chevron-down-DOpVs1Mm.js";import"./skeleton-DeAfgcQK.js";import"./use-effective-tenant-6xYuTafE.js";import"./trash-2-C9dHTECi.js";import"./en-US-DSSwd-Ay.js";import"./endOfMonth-BNqLjwTF.js";import"./user-tVN0-8fp.js";import"./file-text-BaK0CXIP.js";import"./credit-card-CRs7L-78.js";import"./mail-CwNPBuud.js";import"./shield-IA8j3DE0.js";import"./circle-alert-CvqXQmI-.js";import"./package-ChfYgdRA.js";import"./wallet-CqZJpKq_.js";import"./building-2-CdICHkKN.js";import"./chevron-right-CrQYE_m4.js";import"./sonner-Dh23Qk9O.js";import"./index-rHsITjXj.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]],b=S("CalendarRange",V);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],X=S("Square",W);function Z(a){const r=a.user;return r?`${r.first_name||""} ${r.last_name||""}`.trim()||r.email||`Staff #${a.id}`:`Staff #${a.id}`}function Ve({staff:a}){const r=U(),v=[{title:"HR",href:r.route("hr.staff.index")},{title:"Payments",href:r.route("hr.payments.index")},{title:"New payment run",href:r.route("hr.payments.create")}],l=k.useMemo(()=>a.map(t=>t.id),[a]),{data:s,setData:n,post:M,processing:w,errors:_}=I({period_start:"",period_end:"",staff_ids:l,prorate:!1,narration:""}),m=t=>String(t).padStart(2,"0"),h=t=>{const i=new Date,x=new Date(i.getFullYear(),i.getMonth()+t,1),d=x.getFullYear(),u=x.getMonth(),q=x.toLocaleString(void 0,{month:"long"}),z=new Date(d,u+1,0),B=`${d}-${m(u+1)}-01`,E=`${d}-${m(u+1)}-${m(z.getDate())}`;n({...s,period_start:B,period_end:E,narration:`Salary ${q} ${d}`})},L=()=>h(-1),$=()=>h(0),D=()=>h(1);k.useEffect(()=>{l.length>0&&s.staff_ids.length===0&&n("staff_ids",l)},[l.length]);const F=t=>{n("staff_ids",s.staff_ids.includes(t)?s.staff_ids.filter(i=>i!==t):[...s.staff_ids,t])},H=()=>n("staff_ids",[...l]),P=()=>n("staff_ids",[]),p=s.staff_ids.length,R=t=>{t.preventDefault(),s.staff_ids.length!==0&&M(r.route("hr.payments.store"),{preserveScroll:!0})},A=s.period_start&&s.period_end&&p>0&&!w;return e.jsxs(O,{breadcrumbs:v,children:[e.jsx(T,{title:"New payment run"}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx("div",{className:"border-b bg-gradient-to-b from-muted/30 to-background",children:e.jsx("div",{className:"mx-auto max-w-6xl px-4 py-6 sm:px-6",children:e.jsx("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o,{variant:"ghost",size:"icon",className:"shrink-0",asChild:!0,children:e.jsx(C,{href:r.route("hr.payments.index"),children:e.jsx(Y,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:"New payment run"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Set the period and choose which staff to include. Payments are calculated from their salary, allowances, and deductions."})]})]})})})}),e.jsx("div",{className:"mx-auto w-full max-w-6xl flex-1 px-4 py-6 sm:px-6",children:e.jsxs("form",{onSubmit:R,className:"space-y-6",children:[Object.keys(_).length>0&&e.jsxs("div",{className:"rounded-xl border border-destructive/30 bg-destructive/5 px-4 py-3 text-sm text-destructive",children:[e.jsx("p",{className:"font-medium",children:"Please fix the following:"}),e.jsx("ul",{className:"mt-1.5 list-inside list-disc space-y-0.5",children:Object.entries(_).map(([t,i])=>e.jsx("li",{children:i},t))})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[e.jsxs(f,{className:"border-muted/50 shadow-sm",children:[e.jsxs(g,{className:"pb-3",children:[e.jsxs(j,{className:"flex items-center gap-2 text-base",children:[e.jsx("span",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary/10 text-primary",children:e.jsx(J,{className:"h-4 w-4"})}),"Payment period"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Start and end dates for this run. By default, monthly-paid staff get their full base salary for the period; tick the option below to prorate by days."})]}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"prorate",checked:s.prorate,onChange:t=>n("prorate",t.target.checked),className:"h-4 w-4 rounded border-muted-foreground"}),e.jsx(c,{htmlFor:"prorate",className:"cursor-pointer font-normal",children:"Prorate amounts by days in period (e.g. half month = half salary). Leave unchecked for full monthly amount."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:L,className:"gap-1.5",children:[e.jsx(b,{className:"h-4 w-4"}),"Last month"]}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:$,className:"gap-1.5",children:[e.jsx(b,{className:"h-4 w-4"}),"This month"]}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:D,className:"gap-1.5",children:[e.jsx(b,{className:"h-4 w-4"}),"Next month"]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"period_start",children:"Period start *"}),e.jsx(N,{id:"period_start",type:"date",required:!0,value:s.period_start,onChange:t=>n("period_start",t.target.value),className:"bg-background"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"period_end",children:"Period end *"}),e.jsx(N,{id:"period_end",type:"date",required:!0,value:s.period_end,onChange:t=>n("period_end",t.target.value),className:"bg-background"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"narration",children:"Narration / payment reference"}),e.jsx(N,{id:"narration",placeholder:"e.g. Salary January 2026",value:s.narration??"",onChange:t=>n("narration",t.target.value),className:"bg-background"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Shown on the run and payment slips; use as reference when making the transfer."})]})]})]}),e.jsxs(f,{className:"border-muted/50 shadow-sm",children:[e.jsxs(g,{className:"pb-3",children:[e.jsxs(j,{className:"flex items-center gap-2 text-base",children:[e.jsx("span",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary/10 text-primary",children:e.jsx(G,{className:"h-4 w-4"})}),"Staff to include"]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(o,{type:"button",variant:"outline",size:"sm",onClick:H,children:"Select all"}),e.jsx(o,{type:"button",variant:"outline",size:"sm",onClick:P,children:"Deselect all"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[p," of ",a.length," selected"]}),p===0&&e.jsx("span",{className:"text-sm text-amber-600",children:"Select at least one staff member."})]})]}),e.jsx(y,{children:a.length===0?e.jsx("p",{className:"rounded-lg border border-dashed border-muted-foreground/25 bg-muted/10 py-8 text-center text-sm text-muted-foreground",children:"No active staff with HR details. Add staff and set salaries first."}):e.jsx("ul",{className:"space-y-1 rounded-lg border border-muted/50 divide-y divide-muted/50 max-h-[320px] overflow-y-auto",children:a.map(t=>{const i=s.staff_ids.includes(t.id);return e.jsx("li",{children:e.jsxs("label",{className:"flex cursor-pointer items-center gap-3 px-3 py-2.5 transition-colors hover:bg-muted/30",children:[e.jsx("span",{className:"flex shrink-0",children:i?e.jsx(K,{className:"h-5 w-5 text-primary"}):e.jsx(X,{className:"h-5 w-5 text-muted-foreground"})}),e.jsx("input",{type:"checkbox",className:"sr-only",checked:i,onChange:()=>F(t.id)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium",children:Z(t)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[[t.job_title,t.department].filter(Boolean).join(" · ")||"No role",t.monthly_net!=null&&e.jsxs(e.Fragment,{children:[" · Est. ",t.salary_currency," ",t.monthly_net.toLocaleString(void 0,{minimumFractionDigits:2}),"/mo"]})]})]})]})},t.id)})})})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(o,{type:"submit",disabled:!A,children:w?"Creating…":"Create payment run"}),e.jsx(o,{type:"button",variant:"outline",asChild:!0,children:e.jsx(C,{href:r.route("hr.payments.index"),children:"Cancel"})})]})]}),e.jsx("div",{className:"space-y-6 lg:col-span-1",children:e.jsxs(f,{className:"border-muted/50 shadow-sm",children:[e.jsx(g,{className:"pb-3",children:e.jsxs(j,{className:"flex items-center gap-2 text-base",children:[e.jsx(Q,{className:"h-4 w-4 text-muted-foreground"}),"How it works"]})}),e.jsxs(y,{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsxs("p",{children:["Each selected staff gets a line item. The amount is computed from their ",e.jsx("strong",{children:"salary"}),", ",e.jsx("strong",{children:"allowances"}),", and ",e.jsx("strong",{children:"deductions"})," for the period."]}),e.jsxs("p",{children:["After creating the run you can review amounts, then ",e.jsx("strong",{children:"pay individually"})," or ",e.jsx("strong",{children:"process the whole run"})," at once."]})]})]})})]})]})})]})]})}export{Ve as default};
