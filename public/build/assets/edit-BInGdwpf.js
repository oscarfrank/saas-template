import{r as z,u as q,j as e,H,L as S}from"./app-BCbVRjYH.js";import{A as G}from"./app-layout-DDUYIrv9.js";import{B as v}from"./button-uRfG0SJk.js";import{C as u,c as x,a as _}from"./card-BD7iHYUQ.js";import{I as c}from"./input-CrGy8JR3.js";import{L as i}from"./label-B0XYP5fN.js";import{T as F}from"./textarea-0iTykI8f.js";import{u as M}from"./use-tenant-router-DiYxGHG9.js";import{S as d,a as m,b as h,c as p,d as n}from"./select-DxJnkH9K.js";import{C as J}from"./checkbox-DIRYI8vl.js";import{A as $}from"./arrow-left-BfZHK7-S.js";import{T as K}from"./trash-2-DpopIwP-.js";import{C as Q}from"./camera-rWjNy4gT.js";import{P as W}from"./package-DUGkiw1_.js";import{U as X}from"./user-B55N5piZ.js";import{B as Y}from"./banknote-DO-wJ5fb.js";import{F as Z}from"./file-text-CFSx456Y.js";/* empty css            */import"./breadcrumb-Kf_Jua1h.js";import"./utils-DawFQoOT.js";import"./sheet-BWAeJB6C.js";import"./index-DPt8kAZf.js";import"./index-D8qEZ9Gx.js";import"./index-BUJG5R3i.js";import"./index-yqb1x3RI.js";import"./index-CGjHmAMw.js";import"./index-BtBzczEp.js";import"./index-J5wWsuif.js";import"./x-D611PGoW.js";import"./createLucideIcon-GhyqP1ys.js";import"./index-oDWWD3I5.js";import"./index-CRLWXLw8.js";import"./index-BKQezIhM.js";import"./dropdown-menu-RgYEZTz0.js";import"./index-CsWEytiP.js";import"./index-B-AhuyaU.js";import"./check-B9bfcpBy.js";import"./chevron-down-RiCOlSmY.js";import"./skeleton-BmqfrkAd.js";import"./use-effective-tenant-CQ6us_Au.js";import"./en-US-DSSwd-Ay.js";import"./endOfMonth-BNqLjwTF.js";import"./dollar-sign-CPcgpTPL.js";import"./credit-card-BcosqvxM.js";import"./mail-hckPM3CY.js";import"./shield-DZlKfUFe.js";import"./circle-alert-DuZXvBOf.js";import"./users-69zSRrQI.js";import"./wallet-CbL3ywdH.js";import"./building-2-CxDNleOb.js";import"./chevron-right-BmqFOubz.js";import"./sonner-D7WukHuY.js";import"./index-DQu8XgdM.js";import"./index-BBDGBUIr.js";function D(r){return r?new Date(r).toISOString().slice(0,10):""}function es({asset:r,categories:y,users:k,statusOptions:P,conditionOptions:A,currencyOptions:I,receipt_url:f,receipt_is_image:b,photo_url:C,default_sold_currency:L="USD"}){const o=M(),O=z.useRef(null),R=[{title:"Assets",href:o.route("assets.index")},{title:r.name,href:o.route("assets.show",{asset:r.uuid})},{title:"Edit",href:o.route("assets.edit",{asset:r.uuid})}],{data:a,setData:t,post:U,processing:w,errors:j}=q({name:r.name,asset_tag:r.asset_tag,asset_category_id:r.asset_category_id??"",serial_number:r.serial_number??"",description:r.description??"",status:r.status,assigned_to_user_id:r.assigned_to_user_id??"",purchase_date:D(r.purchase_date),purchase_price:r.purchase_price??"",currency:r.currency||"USD",location:r.location??"",notes:r.notes??"",condition:r.condition??"",disposed_reason:r.disposed_reason??"",sold_at:r.sold_at?D(r.sold_at):"",sold_price:r.sold_price??"",sold_currency:r.sold_currency??r.currency??L,depreciation_useful_life_years:r.depreciation_useful_life_years??"",depreciation_salvage_value:r.depreciation_salvage_value??"",receipt:null,remove_receipt:!1,photo:null,remove_photo:!1}),B=s=>{s.preventDefault(),U(o.route("assets.update",{asset:r.uuid}),{preserveScroll:!0,forceFormData:!0,method:"put"})},E=["sold","gifted","lost","damaged","retired","disposed"].includes(a.status),T=a.status==="sold",g={...I};r.currency&&!(r.currency in g)&&(g[r.currency]=r.currency);const N=a.photo?URL.createObjectURL(a.photo):null,V=C&&!a.remove_photo&&!N;return e.jsxs(G,{breadcrumbs:R,children:[e.jsx(H,{title:`Edit ${r.name}`}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(v,{variant:"ghost",size:"icon",asChild:!0,children:e.jsx(S,{href:o.route("assets.show",{asset:r.uuid}),children:e.jsx($,{className:"h-5 w-5"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:"Edit asset"}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:[r.name," · ",r.asset_tag]})]})]}),e.jsxs("form",{onSubmit:B,className:"space-y-8",children:[e.jsxs("div",{className:"grid gap-8 lg:grid-cols-[280px_1fr]",children:[e.jsx(u,{className:"h-fit overflow-hidden border-2 border-dashed lg:border-solid lg:border lg:rounded-2xl",children:e.jsxs(x,{className:"p-0",children:[e.jsxs("label",{className:"flex aspect-square w-full cursor-pointer flex-col items-center justify-center gap-3 bg-muted/20 p-6 transition-colors hover:bg-muted/40",children:[e.jsx("input",{ref:O,type:"file",accept:"image/jpeg,image/png,image/jpg",className:"sr-only",onChange:s=>{var l;t("photo",((l=s.target.files)==null?void 0:l[0])??null),t("remove_photo",!1)}}),N?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:N,alt:"Preview",className:"h-48 w-48 rounded-xl object-cover shadow-inner"}),e.jsx("span",{className:"text-muted-foreground text-sm",children:"Click to change"})]}):V?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:C,alt:"Device",className:"h-48 w-48 rounded-xl object-cover shadow-inner"}),e.jsx("span",{className:"text-muted-foreground text-sm",children:"Click to replace"}),e.jsxs(v,{type:"button",variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive",onClick:s=>{s.preventDefault(),t("remove_photo",!0),t("photo",null)},children:[e.jsx(K,{className:"h-4 w-4 mr-1"}),"Remove photo"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex h-20 w-20 items-center justify-center rounded-2xl bg-primary/10",children:e.jsx(Q,{className:"h-10 w-10 text-primary"})}),e.jsx("span",{className:"text-center text-sm font-medium",children:"Device photo"}),e.jsx("span",{className:"text-muted-foreground text-xs",children:"Optional · JPG or PNG, max 5 MB"})]})]}),a.remove_photo&&e.jsx("p",{className:"px-4 pb-3 text-center text-muted-foreground text-xs",children:"Photo will be removed when you save."})]})}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs(u,{className:"overflow-hidden rounded-2xl border shadow-sm",children:[e.jsx(_,{className:"border-b bg-muted/30 pb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-primary"}),e.jsx("h2",{className:"font-semibold",children:"Basic information"})]})}),e.jsxs(x,{className:"space-y-5 pt-5",children:[e.jsxs("div",{className:"grid gap-5 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"name",children:"Name *"}),e.jsx(c,{id:"name",required:!0,value:a.name,onChange:s=>t("name",s.target.value),className:"h-11"}),j.name&&e.jsx("p",{className:"text-destructive text-sm",children:j.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"asset_tag",children:"Asset tag *"}),e.jsx(c,{id:"asset_tag",required:!0,value:a.asset_tag,onChange:s=>t("asset_tag",s.target.value),className:"h-11"}),j.asset_tag&&e.jsx("p",{className:"text-destructive text-sm",children:j.asset_tag})]})]}),e.jsxs("div",{className:"grid gap-5 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"asset_category_id",children:"Category"}),e.jsxs(d,{value:a.asset_category_id?String(a.asset_category_id):"none",onValueChange:s=>t("asset_category_id",s==="none"?"":Number(s)),children:[e.jsx(m,{id:"asset_category_id",className:"h-11",children:e.jsx(h,{placeholder:"Select category"})}),e.jsxs(p,{children:[e.jsx(n,{value:"none",children:"None"}),y.map(s=>e.jsx(n,{value:String(s.id),children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"serial_number",children:"Serial number"}),e.jsx(c,{id:"serial_number",value:a.serial_number,onChange:s=>t("serial_number",s.target.value),className:"h-11"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"description",children:"Description"}),e.jsx(F,{id:"description",value:a.description,onChange:s=>t("description",s.target.value),rows:2,className:"resize-none"})]})]})]}),e.jsxs(u,{className:"overflow-hidden rounded-2xl border shadow-sm",children:[e.jsx(_,{className:"border-b bg-muted/30 pb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5 text-primary"}),e.jsx("h2",{className:"font-semibold",children:"Status & assignment"})]})}),e.jsxs(x,{className:"space-y-5 pt-5",children:[e.jsxs("div",{className:"grid gap-5 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"status",children:"Status *"}),e.jsxs(d,{value:a.status,onValueChange:s=>t("status",s),children:[e.jsx(m,{id:"status",className:"h-11",children:e.jsx(h,{})}),e.jsx(p,{children:Object.entries(P).map(([s,l])=>e.jsx(n,{value:s,children:l},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"assigned_to_user_id",children:"Assigned to"}),e.jsxs(d,{value:a.assigned_to_user_id?String(a.assigned_to_user_id):"none",onValueChange:s=>t("assigned_to_user_id",s==="none"?"":Number(s)),children:[e.jsx(m,{id:"assigned_to_user_id",className:"h-11",children:e.jsx(h,{placeholder:"Select person"})}),e.jsxs(p,{children:[e.jsx(n,{value:"none",children:"Unassigned"}),k.map(s=>e.jsx(n,{value:String(s.id),children:[s.first_name,s.last_name].filter(Boolean).join(" ")||s.email},s.id))]})]})]})]}),e.jsxs("div",{className:"grid gap-5 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"location",children:"Location"}),e.jsx(c,{id:"location",value:a.location,onChange:s=>t("location",s.target.value),className:"h-11"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"condition",children:"Condition"}),e.jsxs(d,{value:a.condition||"none",onValueChange:s=>t("condition",s==="none"?"":s),children:[e.jsx(m,{id:"condition",className:"h-11",children:e.jsx(h,{placeholder:"Select condition"})}),e.jsxs(p,{children:[e.jsx(n,{value:"none",children:"—"}),Object.entries(A).map(([s,l])=>e.jsx(n,{value:s,children:l},s))]})]})]})]}),E&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"disposed_reason",children:"Disposal reason / notes"}),e.jsx(c,{id:"disposed_reason",value:a.disposed_reason,onChange:s=>t("disposed_reason",s.target.value),className:"h-11"})]})]})]}),e.jsxs(u,{className:"overflow-hidden rounded-2xl border shadow-sm",children:[e.jsx(_,{className:"border-b bg-muted/30 pb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5 text-primary"}),e.jsx("h2",{className:"font-semibold",children:"Purchase & value"})]})}),e.jsxs(x,{className:"space-y-5 pt-5",children:[e.jsxs("div",{className:"grid gap-5 sm:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"purchase_date",children:"Purchase date"}),e.jsx(c,{id:"purchase_date",type:"date",value:a.purchase_date,onChange:s=>t("purchase_date",s.target.value),className:"h-11"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"purchase_price",children:"Purchase price"}),e.jsx(c,{id:"purchase_price",type:"number",step:"0.01",min:"0",value:a.purchase_price,onChange:s=>t("purchase_price",s.target.value),className:"h-11"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"currency",children:"Currency"}),e.jsxs(d,{value:a.currency,onValueChange:s=>t("currency",s),children:[e.jsx(m,{id:"currency",className:"h-11",children:e.jsx(h,{})}),e.jsx(p,{children:Object.entries(g).map(([s,l])=>e.jsx(n,{value:s,children:l},s))})]})]})]}),e.jsxs("div",{className:"space-y-3 border-t pt-4",children:[e.jsx("p",{className:"text-muted-foreground text-sm font-medium",children:"Depreciation override (optional)"}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Override category defaults. Leave blank to use category settings."}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"depreciation_useful_life_years",children:"Useful life (years)"}),e.jsx(c,{id:"depreciation_useful_life_years",type:"number",min:1,max:100,placeholder:"Use category default",value:a.depreciation_useful_life_years===""?"":a.depreciation_useful_life_years,onChange:s=>t("depreciation_useful_life_years",s.target.value===""?"":parseInt(s.target.value,10)),className:"h-11"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"depreciation_salvage_value",children:"Salvage value"}),e.jsx(c,{id:"depreciation_salvage_value",type:"number",min:0,step:.01,placeholder:"0",value:a.depreciation_salvage_value,onChange:s=>t("depreciation_salvage_value",s.target.value),className:"h-11"})]})]}),r.effective_depreciation&&e.jsxs("p",{className:"text-muted-foreground text-xs",children:["Current effective: ",r.effective_depreciation.useful_life_years," years, salvage ",r.effective_depreciation.salvage_value," · Book value: ",r.book_value!=null?new Intl.NumberFormat(void 0,{style:"currency",currency:r.currency}).format(r.book_value):"—"]})]}),T&&e.jsxs("div",{className:"rounded-lg border border-amber-200 bg-amber-50/50 p-4 dark:border-amber-900/50 dark:bg-amber-950/20",children:[e.jsx("p",{className:"mb-3 text-sm font-medium text-amber-800 dark:text-amber-200",children:"Sale details"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"sold_at",children:"Sold date"}),e.jsx(c,{id:"sold_at",type:"date",value:a.sold_at||new Date().toISOString().slice(0,10),onChange:s=>t("sold_at",s.target.value),className:"h-11"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"sold_price",children:"Sold price"}),e.jsx(c,{id:"sold_price",type:"number",step:"0.01",min:"0",value:a.sold_price,onChange:s=>t("sold_price",s.target.value),className:"h-11",placeholder:"Amount received"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"sold_currency",children:"Sold in currency"}),e.jsxs(d,{value:a.sold_currency||r.currency,onValueChange:s=>t("sold_currency",s),children:[e.jsx(m,{id:"sold_currency",className:"h-11",children:e.jsx(h,{placeholder:"Currency received"})}),e.jsx(p,{children:Object.entries(g).map(([s,l])=>e.jsx(n,{value:s,children:l},s))})]})]})]})]})]})]}),e.jsxs(u,{className:"overflow-hidden rounded-2xl border shadow-sm",children:[e.jsx(_,{className:"border-b bg-muted/30 pb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5 text-primary"}),e.jsx("h2",{className:"font-semibold",children:"Documents & notes"})]})}),e.jsxs(x,{className:"space-y-5 pt-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"receipt",children:"Receipt / document"}),f&&e.jsxs("div",{className:"space-y-2 rounded-lg border bg-muted/30 p-4",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:"A receipt is on file. Upload a new file to replace it, or remove it below."}),b&&e.jsx("img",{src:f,alt:"Current receipt",className:"max-h-40 rounded border object-contain"}),e.jsx("a",{href:f,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-sm text-primary hover:underline",download:!0,children:b?"Download current image":"Download current document"}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[e.jsx(J,{id:"remove_receipt",checked:a.remove_receipt,onCheckedChange:s=>t("remove_receipt",!!s)}),e.jsx(i,{htmlFor:"remove_receipt",className:"cursor-pointer text-sm font-normal",children:"Remove receipt (no replacement)"})]})]}),e.jsx(c,{id:"receipt",type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:s=>{var l;return t("receipt",((l=s.target.files)==null?void 0:l[0])??null)},className:"h-11"}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"PDF or image, max 10 MB"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"notes",children:"Internal notes"}),e.jsx(F,{id:"notes",value:a.notes,onChange:s=>t("notes",s.target.value),rows:3,className:"resize-none"})]})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 border-t pt-6",children:[e.jsx(v,{type:"submit",disabled:w,className:"min-w-[140px]",children:w?"Saving…":"Save changes"}),e.jsx(v,{type:"button",variant:"outline",asChild:!0,children:e.jsx(S,{href:o.route("assets.show",{asset:r.uuid}),children:"Cancel"})})]})]})]})]})}export{es as default};
