import{u as F,j as e,H as V,L as q,a as $}from"./app-D_gAFq-V.js";import{A as K}from"./app-layout-BCiSL63D.js";import{B as u}from"./button-BFSYIwtl.js";import{C as p,a as _,b as j,c as f}from"./card-DoeT-v6d.js";import{I as i}from"./input-CmTb5Lxc.js";import{L as o}from"./label-B1gWC-cG.js";import{u as G}from"./use-tenant-router-CyUlpgxO.js";import{S as D,a as T,b as E,c as P,d as h}from"./select-CvOcG97k.js";import{A as J}from"./arrow-left-DKY5D8vS.js";import{P as B}from"./plus-DuFo3s96.js";import{T as H}from"./trash-2-BxxlJLcp.js";/* empty css            */import"./breadcrumb-BSr-d5mP.js";import"./utils-DawFQoOT.js";import"./sheet-BdwvJrRq.js";import"./index-DtqZ64Fm.js";import"./index-Cnz-hDEO.js";import"./index-CcckuZ4v.js";import"./index-D0D4bDTC.js";import"./index-B7I2zNpG.js";import"./index-nTYPKFdy.js";import"./index-Dicx2aIc.js";import"./x-Db-wiWVp.js";import"./createLucideIcon-_LQi4Q30.js";import"./index-CEoUbW3m.js";import"./index-BUnOnUDt.js";import"./index-Dj-tlSHD.js";import"./dropdown-menu-JF5QhWq2.js";import"./index-CRGk-QAc.js";import"./index-COM1D-hK.js";import"./check-BtkFvFIj.js";import"./chevron-down-DQesx_ui.js";import"./skeleton-7aYgOeLs.js";import"./use-effective-tenant-CEbeCMuM.js";import"./en-US-DSSwd-Ay.js";import"./endOfMonth-BNqLjwTF.js";import"./user-ijQw_mBI.js";import"./file-text-BK5MQnTD.js";import"./dollar-sign-gKoqAnNk.js";import"./credit-card-Bp8FcFba.js";import"./mail-B_-3L_XC.js";import"./shield-Cmow8yVJ.js";import"./circle-alert-fwNM582Y.js";import"./layout-grid-GJmsOGMh.js";import"./users-BBmkbSVf.js";import"./wallet-DZICKd1b.js";import"./building-2-LJzAubuK.js";import"./chevron-right-DBGHyw8M.js";import"./sonner-cJ4rpChl.js";import"./index-LIrdw0Kx.js";import"./index-CcAEI6Yp.js";const W=[{value:"paystack",label:"Paystack"},{value:"kuda",label:"Kuda"},{value:"flutterwave",label:"Flutterwave"},{value:"manual",label:"Manual / Other"}];function v(s){if(!(s!=null&&s.user))return"Staff";const x=s.user;return`${x.first_name||""} ${x.last_name||""}`.trim()||x.email||"Staff"}function Ge({payslip:s,paymentMethodLabels:x}){var w,k,C;const d=G(),{data:t,setData:r,processing:b,errors:g}=F({gross:s.gross,net_amount:s.net_amount,deductions_total:s.deductions_total,allowances_detail:s.allowances_detail.map(a=>({name:a.name,amount:String(a.amount)})),deductions_detail:s.deductions_detail.map(a=>({name:a.name,amount:String(a.amount)})),narration:s.narration??"",date_paid:s.date_paid??"",payment_method:s.payment_method??"",tax_id:s.tax_id??"",bank_name:s.bank_name??"",bank_account_number:s.bank_account_number??"",bank_account_name:s.bank_account_name??"",pay_frequency:s.pay_frequency??""}),L=[{title:"HR",href:d.route("hr.staff.index")},{title:"Staff",href:d.route("hr.staff.index")},{title:v(s.staff),href:(w=s.staff)!=null&&w.uuid?d.route("hr.staff.show",{staff:s.staff.uuid}):"#"},{title:"Edit payslip",href:"#"}],R=()=>r("allowances_detail",[...t.allowances_detail,{name:"",amount:""}]),z=a=>r("allowances_detail",t.allowances_detail.filter((n,l)=>l!==a)),y=(a,n,l)=>{const c=[...t.allowances_detail];c[a]={...c[a],[n]:l},r("allowances_detail",c)},O=()=>r("deductions_detail",[...t.deductions_detail,{name:"",amount:""}]),I=a=>r("deductions_detail",t.deductions_detail.filter((n,l)=>l!==a)),N=(a,n,l)=>{const c=[...t.deductions_detail];c[a]={...c[a],[n]:l},r("deductions_detail",c)},M=a=>{var l,c,S,A;a.preventDefault();const n={gross:t.gross,net_amount:t.net_amount,deductions_total:t.deductions_total,allowances_detail:t.allowances_detail.filter(m=>m.name.trim()).map(m=>({name:m.name.trim(),amount:Number(m.amount)||0})),deductions_detail:t.deductions_detail.filter(m=>m.name.trim()).map(m=>({name:m.name.trim(),amount:Number(m.amount)||0})),narration:t.narration||null,date_paid:t.date_paid||null,payment_method:t.payment_method&&t.payment_method!=="_"?t.payment_method:null,tax_id:((l=t.tax_id)==null?void 0:l.trim())||null,bank_name:((c=t.bank_name)==null?void 0:c.trim())||null,bank_account_number:((S=t.bank_account_number)==null?void 0:S.trim())||null,bank_account_name:((A=t.bank_account_name)==null?void 0:A.trim())||null,pay_frequency:t.pay_frequency&&t.pay_frequency!=="_"?t.pay_frequency:null};$.put(d.route("hr.payslips.update",{payslip:s.id}),n,{preserveScroll:!0})};return e.jsxs(K,{breadcrumbs:L,children:[e.jsx(V,{title:`Edit payslip – ${v(s.staff)}`}),e.jsxs("div",{className:"mx-auto max-w-3xl px-4 py-6 sm:px-6",children:[e.jsxs("div",{className:"mb-6 flex items-center gap-2",children:[e.jsx(u,{variant:"ghost",size:"icon",asChild:!0,children:e.jsx(q,{href:(k=s.staff)!=null&&k.uuid?d.route("hr.staff.show",{staff:s.staff.uuid}):d.route("hr.staff.index"),children:e.jsx(J,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Edit payslip"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.period_start," – ",s.period_end," · ",v(s.staff)]})]})]}),e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[Object.keys(g).length>0&&e.jsx("div",{className:"rounded-lg border border-destructive/30 bg-destructive/5 px-4 py-3 text-sm text-destructive",children:e.jsx("ul",{className:"list-inside list-disc",children:Object.entries(g).map(([a,n])=>e.jsx("li",{children:n},a))})}),e.jsxs(p,{children:[e.jsx(_,{children:e.jsx(j,{className:"text-base",children:"Amounts"})}),e.jsx(f,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Gross"}),e.jsx(i,{type:"number",step:"0.01",min:"0",value:t.gross,onChange:a=>r("gross",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Total deductions"}),e.jsx(i,{type:"number",step:"0.01",min:"0",value:t.deductions_total,onChange:a=>r("deductions_total",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Net pay"}),e.jsx(i,{type:"number",step:"0.01",min:"0",value:t.net_amount,onChange:a=>r("net_amount",a.target.value)})]})]})})]}),e.jsxs(p,{children:[e.jsxs(_,{className:"flex flex-row items-center justify-between",children:[e.jsx(j,{className:"text-base",children:"Bonuses / allowances"}),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:R,children:[e.jsx(B,{className:"mr-1 h-4 w-4"})," Add"]})]}),e.jsx(f,{className:"space-y-2",children:t.allowances_detail.map((a,n)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{placeholder:"Name",value:a.name,onChange:l=>y(n,"name",l.target.value),className:"flex-1"}),e.jsx(i,{type:"number",step:"0.01",min:"0",placeholder:"Amount",value:a.amount,onChange:l=>y(n,"amount",l.target.value),className:"w-28"}),e.jsx(u,{type:"button",variant:"ghost",size:"icon",onClick:()=>z(n),children:e.jsx(H,{className:"h-4 w-4 text-destructive"})})]},n))})]}),e.jsxs(p,{children:[e.jsxs(_,{className:"flex flex-row items-center justify-between",children:[e.jsx(j,{className:"text-base",children:"Deductions"}),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:O,children:[e.jsx(B,{className:"mr-1 h-4 w-4"})," Add"]})]}),e.jsx(f,{className:"space-y-2",children:t.deductions_detail.map((a,n)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{placeholder:"Name",value:a.name,onChange:l=>N(n,"name",l.target.value),className:"flex-1"}),e.jsx(i,{type:"number",step:"0.01",min:"0",placeholder:"Amount",value:a.amount,onChange:l=>N(n,"amount",l.target.value),className:"w-28"}),e.jsx(u,{type:"button",variant:"ghost",size:"icon",onClick:()=>I(n),children:e.jsx(H,{className:"h-4 w-4 text-destructive"})})]},n))})]}),e.jsxs(p,{children:[e.jsxs(_,{children:[e.jsx(j,{className:"text-base",children:"Bank & tax (at time of pay)"}),e.jsx("p",{className:"text-sm font-normal text-muted-foreground",children:"Shown on the printed slip. Edit if the payment was made to different bank details (e.g. old account)."})]}),e.jsxs(f,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Tax ID"}),e.jsx(i,{value:t.tax_id,onChange:a=>r("tax_id",a.target.value),placeholder:"Optional"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Bank name"}),e.jsx(i,{value:t.bank_name,onChange:a=>r("bank_name",a.target.value),placeholder:"e.g. Kuda"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Account name"}),e.jsx(i,{value:t.bank_account_name,onChange:a=>r("bank_account_name",a.target.value),placeholder:"Name on account"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Account number"}),e.jsx(i,{value:t.bank_account_number,onChange:a=>r("bank_account_number",a.target.value),placeholder:"Full number (slip shows last 4)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Pay frequency"}),e.jsxs(D,{value:t.pay_frequency||"_",onValueChange:a=>r("pay_frequency",a==="_"?"":a),children:[e.jsx(T,{children:e.jsx(E,{placeholder:"Select"})}),e.jsxs(P,{children:[e.jsx(h,{value:"monthly",children:"Monthly"}),e.jsx(h,{value:"weekly",children:"Weekly"}),e.jsx(h,{value:"bi_weekly",children:"Bi-weekly"}),e.jsx(h,{value:"_",children:"—"})]})]})]})]})]}),e.jsxs(p,{children:[e.jsx(_,{children:e.jsx(j,{className:"text-base",children:"Reference & payment"})}),e.jsxs(f,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Narration / reference"}),e.jsx(i,{placeholder:"e.g. Salary January 2022",value:t.narration,onChange:a=>r("narration",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Date paid"}),e.jsx(i,{type:"date",value:t.date_paid,onChange:a=>r("date_paid",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Payment method"}),e.jsxs(D,{value:t.payment_method||"_",onValueChange:a=>r("payment_method",a==="_"?"":a),children:[e.jsx(T,{children:e.jsx(E,{placeholder:"Select"})}),e.jsxs(P,{children:[W.map(a=>e.jsx(h,{value:a.value,children:x[a.value]??a.label},a.value)),e.jsx(h,{value:"_",children:"—"})]})]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{type:"submit",disabled:b,children:b?"Saving…":"Save changes"}),e.jsx(u,{type:"button",variant:"outline",asChild:!0,children:e.jsx(q,{href:(C=s.staff)!=null&&C.uuid?d.route("hr.staff.show",{staff:s.staff.uuid}):d.route("hr.staff.index"),children:"Cancel"})})]})]})]})]})}export{Ge as default};
