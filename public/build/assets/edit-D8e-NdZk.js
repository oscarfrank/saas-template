import{j as e,u as X,r as h,b as Z,H as ee,L as v,a as w}from"./app-gPN8amc9.js";import{A as ae}from"./app-layout-m1QNDmTO.js";import{B as u}from"./button-Cj2SoaIi.js";import{C as x,a as g,b as j,c as y}from"./card-jiY-BaUL.js";import{I as c}from"./input-B79_MU8S.js";import{L as i}from"./label-C2dxOHx6.js";import{u as se}from"./use-tenant-router-D3DXtB31.js";import{S as k,a as C,b as S,c as D,d as b}from"./select-DS7Eqww7.js";import{H as te,S as re}from"./constants-DMk5EQYl.js";import{PassportPhotoUpload as ne}from"./PassportPhotoUpload-DdZ8bkon.js";import{t as le}from"./index-j2LBsrE0.js";import{A as ce}from"./arrow-left-CfrPOGod.js";import{B as ie}from"./briefcase-BXJZ9vBQ.js";import{B as oe}from"./banknote-TsoRI6so.js";import{T as F}from"./trash-2-DSsJUvYH.js";import{P as R}from"./plus-BuZdw3SU.js";import{C as de}from"./credit-card-G68fBoPd.js";import{I as me}from"./image-BBppMQ1r.js";import{F as ue}from"./file-text-B43tV5Ij.js";import{D as pe}from"./download-CtCxA5ox.js";/* empty css            */import"./breadcrumb-CsU1Tz76.js";import"./utils-DawFQoOT.js";import"./sheet-DFPrmmg7.js";import"./index-DqyYBftF.js";import"./index-60DjX2N9.js";import"./index-DUKhY4gL.js";import"./index-D87sG7sC.js";import"./index-hgHPmbz7.js";import"./index-Dhn2z-om.js";import"./index-iDhR6Kym.js";import"./x-iIZXAApY.js";import"./createLucideIcon-RyF2jhNp.js";import"./index-Dw7ZRzTR.js";import"./index-N1Ys4I5G.js";import"./index-ACXiQFsW.js";import"./dropdown-menu-CbdLkicC.js";import"./index-COqnm0fp.js";import"./index-CwyY0wof.js";import"./check--GgJOlMB.js";import"./chevron-down-CvfYYazo.js";import"./skeleton-C1y8al6Q.js";import"./use-effective-tenant-D6Q0a9Kt.js";import"./en-US-DSSwd-Ay.js";import"./endOfMonth-BNqLjwTF.js";import"./user-oXVagHGM.js";import"./dollar-sign-D9IVVGzk.js";import"./mail-CoV0uW20.js";import"./shield-WeHZPON-.js";import"./circle-alert-BYLTzm0A.js";import"./package-BLUjTLsq.js";import"./users-BA1uD91c.js";import"./wallet-C1o0NA-e.js";import"./building-2-CIJou526.js";import"./chevron-right-DN0aDYO-.js";import"./sonner-Cdv8P1tn.js";import"./index-C4I1ptta.js";import"./upload-D1ZJHQ3j.js";function q(s){return{name:s.name,amount:typeof s.amount=="number"?String(s.amount):s.amount||""}}function L(s){if(s==null||s==="")return"";const o=String(s);if(/^\d{4}-\d{2}-\d{2}/.test(o))return o.slice(0,10);const p=new Date(o);return Number.isNaN(p.getTime())?"":p.toISOString().slice(0,10)}function he({staff:s}){const o=se(),p=s.user?`${s.user.first_name||""} ${s.user.last_name||""}`.trim()||s.user.email:"Staff",{data:t,setData:n,processing:N,errors:V}=X({employee_id:s.employee_id??"",department:s.department??"",job_title:s.job_title??"",salary:s.salary??"",salary_currency:s.salary_currency||"USD",pay_frequency:s.pay_frequency??"",salary_pay_day:s.salary_pay_day??"",allowances:(s.allowances||[]).map(q),deductions:(s.deductions||[]).map(q),tax_id:s.tax_id??"",national_id:s.national_id??"",bank_name:s.bank_name??"",bank_account_number:s.bank_account_number??"",bank_account_name:s.bank_account_name??"",started_at:L(s.started_at??s.startedAt),ended_at:L(s.ended_at??s.endedAt)}),[A,O]=h.useState("other"),[E,T]=h.useState(""),[f,I]=h.useState(null),[P,U]=h.useState(!1),[_,z]=h.useState(!1),B={...Z().props.errors??{},...V},$=a=>{if(a.preventDefault(),N||_)return;z(!0);const r=t.allowances.filter(m=>m.name.trim()&&m.amount!==""&&Number(m.amount)>=0),d=t.deductions.filter(m=>m.name.trim()&&m.amount!==""&&Number(m.amount)>=0),l=m=>m&&m!==""?String(m).slice(0,10):null,Q={_method:"PUT",...t,allowances:r,deductions:d,salary:t.salary===""?null:t.salary,salary_pay_day:t.salary_pay_day===""?null:t.salary_pay_day,started_at:l(t.started_at),ended_at:l(t.ended_at)};w.post(o.route("hr.staff.update",{staff:s.uuid}),Q,{preserveScroll:!0,onSuccess:()=>le.success("Staff updated."),onFinish:()=>z(!1)})},M=()=>n("allowances",[...t.allowances,{name:"",amount:""}]),J=a=>n("allowances",t.allowances.filter((r,d)=>d!==a)),W=()=>n("deductions",[...t.deductions,{name:"",amount:""}]),Y=a=>n("deductions",t.deductions.filter((r,d)=>d!==a)),G=a=>{if(a.preventDefault(),!f)return;U(!0);const r=new FormData;r.append("file",f),r.append("type",A),r.append("description",E),w.post(o.route("hr.staff.documents.upload",{staff:s.uuid}),r,{forceFormData:!0,preserveScroll:!0,onFinish:()=>{U(!1),I(null),T("")}})},K=a=>{confirm("Delete this document?")&&w.delete(o.route("hr.staff.documents.destroy",{staff:s.uuid,document:a}),{preserveScroll:!0})},H=s.documents||[];return e.jsxs(ae,{breadcrumbs:[{title:"HR",href:o.route("hr.staff.index")},{title:"Staff",href:o.route("hr.staff.index")},{title:p,href:o.route("hr.staff.show",{staff:s.uuid})},{title:"Edit",href:"#"}],children:[e.jsx(ee,{title:`Edit – ${p}`}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx("div",{className:"border-b bg-gradient-to-b from-muted/30 to-background",children:e.jsx("div",{className:"mx-auto max-w-6xl px-4 py-6 sm:px-6",children:e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{variant:"ghost",size:"icon",className:"shrink-0",asChild:!0,children:e.jsx(v,{href:o.route("hr.staff.show",{staff:s.uuid}),children:e.jsx(ce,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold tracking-tight",children:"Edit staff"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:p})]})]}),e.jsx(u,{asChild:!0,variant:"outline",size:"sm",children:e.jsx(v,{href:o.route("hr.staff.show",{staff:s.uuid}),children:"View profile"})})]})})}),e.jsx("div",{className:"mx-auto w-full max-w-6xl flex-1 px-4 py-6 sm:px-6",children:e.jsxs("form",{onSubmit:$,className:"space-y-6",children:[Object.keys(B).length>0&&e.jsxs("div",{className:"rounded-xl border border-destructive/30 bg-destructive/5 px-4 py-3 text-sm text-destructive",children:[e.jsx("p",{className:"font-medium",children:"Please fix the following errors:"}),e.jsx("ul",{className:"mt-1.5 list-inside list-disc space-y-0.5",children:Object.entries(B).map(([a,r])=>e.jsx("li",{children:r},a))})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[e.jsxs(x,{className:"border-muted/50 shadow-sm",children:[e.jsx(g,{className:"pb-3",children:e.jsxs(j,{className:"flex items-center gap-2 text-base",children:[e.jsx("span",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary/10 text-primary",children:e.jsx(ie,{className:"h-4 w-4"})}),"Employment"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"employee_id",children:"Employee ID"}),e.jsx(c,{id:"employee_id",value:t.employee_id,onChange:a=>n("employee_id",a.target.value),className:"bg-background"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"department",children:"Department"}),e.jsx(c,{id:"department",value:t.department,onChange:a=>n("department",a.target.value),className:"bg-background"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"job_title",children:"Job title"}),e.jsx(c,{id:"job_title",value:t.job_title,onChange:a=>n("job_title",a.target.value),className:"bg-background"})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"started_at",children:"Start date"}),e.jsx(c,{id:"started_at",type:"date",value:t.started_at,onChange:a=>n("started_at",a.target.value),className:"bg-background"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"ended_at",children:"End date"}),e.jsx(c,{id:"ended_at",type:"date",value:t.ended_at,onChange:a=>n("ended_at",a.target.value),className:"bg-background"})]})]})]})]}),e.jsxs(x,{className:"border-muted/50 shadow-sm",children:[e.jsx(g,{className:"pb-3",children:e.jsxs(j,{className:"flex items-center gap-2 text-base",children:[e.jsx("span",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary/10 text-primary",children:e.jsx(oe,{className:"h-4 w-4"})}),"Compensation"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"salary",children:"Salary"}),e.jsx(c,{id:"salary",type:"number",step:"0.01",min:"0",value:t.salary,onChange:a=>n("salary",a.target.value),className:"bg-background"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"salary_currency",children:"Currency"}),e.jsxs(k,{value:t.salary_currency,onValueChange:a=>n("salary_currency",a),children:[e.jsx(C,{id:"salary_currency",className:"bg-background",children:e.jsx(S,{})}),e.jsx(D,{children:te.map(a=>e.jsx(b,{value:a.code,children:a.label},a.code))})]})]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"pay_frequency",children:"Pay frequency"}),e.jsxs(k,{value:t.pay_frequency||void 0,onValueChange:a=>n("pay_frequency",a),children:[e.jsx(C,{id:"pay_frequency",className:"bg-background",children:e.jsx(S,{placeholder:"Select"})}),e.jsxs(D,{children:[e.jsx(b,{value:"weekly",children:"Weekly"}),e.jsx(b,{value:"bi_weekly",children:"Bi-weekly"}),e.jsx(b,{value:"monthly",children:"Monthly"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"salary_pay_day",children:"Pay day (day of month)"}),e.jsx(c,{id:"salary_pay_day",type:"number",min:1,max:31,placeholder:"e.g. 25",value:t.salary_pay_day===""?"":t.salary_pay_day,onChange:a=>n("salary_pay_day",a.target.value===""?"":Number(a.target.value)),className:"bg-background"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Allowances"}),t.allowances.map((a,r)=>e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx(c,{placeholder:"Name (e.g. Housing)",value:a.name,onChange:d=>{const l=[...t.allowances];l[r]={...l[r],name:d.target.value},n("allowances",l)},className:"bg-background"}),e.jsx(c,{type:"number",step:"0.01",min:"0",placeholder:"Amount",className:"w-28 bg-background",value:a.amount,onChange:d=>{const l=[...t.allowances];l[r]={...l[r],amount:d.target.value},n("allowances",l)}}),e.jsx(u,{type:"button",variant:"ghost",size:"icon",className:"shrink-0 text-muted-foreground hover:text-destructive",onClick:()=>J(r),children:e.jsx(F,{className:"h-4 w-4"})})]},r)),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:M,className:"mt-1",children:[e.jsx(R,{className:"mr-1.5 h-4 w-4"})," Add allowance"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Deductions"}),t.deductions.map((a,r)=>e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx(c,{placeholder:"Name (e.g. Tax, Pension)",value:a.name,onChange:d=>{const l=[...t.deductions];l[r]={...l[r],name:d.target.value},n("deductions",l)},className:"bg-background"}),e.jsx(c,{type:"number",step:"0.01",min:"0",placeholder:"Amount",className:"w-28 bg-background",value:a.amount,onChange:d=>{const l=[...t.deductions];l[r]={...l[r],amount:d.target.value},n("deductions",l)}}),e.jsx(u,{type:"button",variant:"ghost",size:"icon",className:"shrink-0 text-muted-foreground hover:text-destructive",onClick:()=>Y(r),children:e.jsx(F,{className:"h-4 w-4"})})]},r)),e.jsxs(u,{type:"button",variant:"outline",size:"sm",onClick:W,className:"mt-1",children:[e.jsx(R,{className:"mr-1.5 h-4 w-4"})," Add deduction"]})]})]})]}),e.jsxs(x,{className:"border-muted/50 shadow-sm",children:[e.jsx(g,{className:"pb-3",children:e.jsxs(j,{className:"flex items-center gap-2 text-base",children:[e.jsx("span",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary/10 text-primary",children:e.jsx(de,{className:"h-4 w-4"})}),"Identity & banking"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"tax_id",children:"Tax ID"}),e.jsx(c,{id:"tax_id",value:t.tax_id,onChange:a=>n("tax_id",a.target.value),className:"bg-background"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"national_id",children:"National ID"}),e.jsx(c,{id:"national_id",value:t.national_id,onChange:a=>n("national_id",a.target.value),className:"bg-background"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"bank_name",children:"Bank name"}),e.jsx(c,{id:"bank_name",value:t.bank_name,onChange:a=>n("bank_name",a.target.value),className:"bg-background"})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"bank_account_number",children:"Account number"}),e.jsx(c,{id:"bank_account_number",type:"number",inputMode:"numeric",min:0,value:t.bank_account_number,onChange:a=>n("bank_account_number",a.target.value),className:"bg-background"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"bank_account_name",children:"Account name"}),e.jsx(c,{id:"bank_account_name",value:t.bank_account_name,onChange:a=>n("bank_account_name",a.target.value),className:"bg-background"})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(u,{type:"submit",disabled:N||_,"aria-busy":N||_,children:N||_?"Saving…":"Save changes"}),e.jsx(u,{type:"button",variant:"outline",asChild:!0,children:e.jsx(v,{href:o.route("hr.staff.show",{staff:s.uuid}),children:"Cancel"})})]})]}),e.jsxs("div",{className:"space-y-6 lg:col-span-1",children:[e.jsxs(x,{className:"border-muted/50 shadow-sm",children:[e.jsx(g,{className:"pb-3",children:e.jsxs(j,{className:"flex items-center gap-2 text-base",children:[e.jsx("span",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary/10 text-primary",children:e.jsx(me,{className:"h-4 w-4"})}),"Passport photo"]})}),e.jsx(y,{children:e.jsx(ne,{staffUuid:s.uuid,currentPhotoUrl:s.passport_photo_path?o.route("hr.staff.passport",{staff:s.uuid}):null})})]}),e.jsxs(x,{className:"border-muted/50 shadow-sm",children:[e.jsxs(g,{className:"pb-3",children:[e.jsxs(j,{className:"flex items-center gap-2 text-base",children:[e.jsx("span",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary/10 text-primary",children:e.jsx(ue,{className:"h-4 w-4"})}),"Documents"]}),e.jsx("p",{className:"text-sm font-normal text-muted-foreground",children:"Contracts, ID, certificates"})]}),e.jsxs(y,{className:"space-y-4",children:[H.length>0?e.jsx("ul",{className:"space-y-2",children:H.map(a=>e.jsxs("li",{className:"flex items-center justify-between gap-2 rounded-lg border border-muted/50 bg-muted/20 px-3 py-2",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate text-sm font-medium",children:a.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.type,a.description?` · ${a.description}`:""]})]}),e.jsxs("div",{className:"flex shrink-0 gap-1",children:[e.jsx(u,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",asChild:!0,children:e.jsx("a",{href:o.route("hr.staff.documents.download",{staff:s.uuid,document:a.id}),target:"_blank",rel:"noopener noreferrer",children:e.jsx(pe,{className:"h-4 w-4"})})}),e.jsx(u,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-destructive",onClick:()=>K(a.id),children:e.jsx(F,{className:"h-4 w-4"})})]})]},a.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No documents yet."}),e.jsxs("form",{onSubmit:G,className:"space-y-3 rounded-lg border border-dashed border-muted/50 bg-muted/10 p-3",children:[e.jsxs(k,{value:A,onValueChange:O,children:[e.jsx(C,{className:"bg-background",children:e.jsx(S,{})}),e.jsx(D,{children:re.map(a=>e.jsx(b,{value:a.value,children:a.label},a.value))})]}),e.jsx(c,{type:"file",className:"bg-background",onChange:a=>{var r;return I(((r=a.target.files)==null?void 0:r[0])??null)}}),e.jsx(c,{placeholder:"Description (optional)",value:E,onChange:a=>T(a.target.value),className:"bg-background"}),e.jsx(u,{type:"submit",disabled:!f||P,size:"sm",className:"w-full",children:P?"Uploading…":"Upload"})]})]})]})]})]})]})})]})]})}function Na(s){return e.jsx(he,{...s},s.staff.uuid)}export{Na as default};
