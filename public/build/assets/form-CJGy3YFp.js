import{r as l,j as e,a as i}from"./app-C6kPN11i.js";import{B as h}from"./button-BpcDdXY5.js";import{I as x}from"./input-DeRGwPqG.js";import{T as N}from"./textarea-XQGu6FqI.js";import{S as y}from"./switch-Dtk_QLEt.js";import{B as S}from"./badge-CU1YL7MN.js";import{C as w,a as T,b as D,c as E,d as _}from"./card-BmLtWeUg.js";import{C as O}from"./custom-alert-dialog-Ci1IYU57.js";import{t as c}from"./index-BdMXpxBe.js";/* empty css            */import"./utils-DawFQoOT.js";import"./index-BgupMaT4.js";import"./index-DHeuMB84.js";import"./index-DjhqQPoh.js";function J({template:s,placeholders:p}){const[r,n]=l.useState({name:(s==null?void 0:s.name)||"",shortcode:(s==null?void 0:s.shortcode)||"",content:(s==null?void 0:s.content)||"",placeholders:(s==null?void 0:s.placeholders)||[],is_active:(s==null?void 0:s.is_active)??!0}),[d,o]=l.useState(!1),[f,m]=l.useState(!1),j=t=>{t.preventDefault(),o(!0),s?i.put(route("email-templates.update",s.id),r,{onSuccess:()=>{c.success("Template updated successfully"),o(!1)},onError:()=>{c.error("Failed to update template"),o(!1)}}):i.post(route("email-templates.store"),r,{onSuccess:()=>{c.success("Template created successfully"),o(!1)},onError:()=>{c.error("Failed to create template"),o(!1)}})},v=()=>{r.name||r.content?m(!0):i.visit(route("email-templates.index"))},C=t=>{const a=document.querySelector("textarea"),u=(a==null?void 0:a.selectionStart)||r.content.length,g=r.content.slice(0,u)+`{{${t}}}`+r.content.slice(u);n(b=>({...b,content:g}))};return e.jsxs("form",{onSubmit:j,className:"space-y-8",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Name"}),e.jsx(x,{placeholder:"Enter template name",value:r.name,onChange:t=>n(a=>({...a,name:t.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Shortcode"}),e.jsx(x,{placeholder:"e.g., welcome_email, loan_approval",value:r.shortcode,onChange:t=>n(a=>({...a,shortcode:t.target.value.toLowerCase().replace(/\s+/g,"_")})),required:!0,pattern:"[a-z0-9_]+",title:"Only lowercase letters, numbers, and underscores are allowed"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This will be used to reference the template in code"})]})]}),e.jsxs(w,{children:[e.jsxs(T,{children:[e.jsx(D,{children:"Available Placeholders"}),e.jsx(E,{children:"Click on a placeholder to insert it into the content"})]}),e.jsx(_,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(p).map(([t,a])=>e.jsx(S,{variant:"secondary",className:"cursor-pointer",onClick:()=>C(t),children:`{{${t}}}`},t))})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Content"}),e.jsx(N,{placeholder:"Enter email content",className:"min-h-[200px]",value:r.content,onChange:t=>n(a=>({...a,content:t.target.value})),required:!0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Use the placeholders above to insert dynamic content"})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("label",{className:"text-base font-medium",children:"Active"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable or disable this email template"})]}),e.jsx(y,{checked:r.is_active,onCheckedChange:t=>n(a=>({...a,is_active:t}))})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(h,{type:"button",variant:"outline",onClick:v,disabled:d,children:"Cancel"}),e.jsx(h,{type:"submit",disabled:d,children:s?"Update Template":"Create Template"})]}),e.jsx(O,{isOpen:f,onClose:()=>m(!1),onConfirm:()=>i.visit(route("email-templates.index")),title:"Discard Changes",description:"Are you sure you want to discard your changes? This action cannot be undone."})]})}export{J as EmailTemplateForm};
