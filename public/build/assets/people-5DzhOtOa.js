import{u as fe,r as i,j as e,H as Ce,a as l}from"./app-AYk_vs9E.js";import{t as a}from"./index-BSCeWBGl.js";import{u as ye}from"./use-tenant-router-yHxY6vf2.js";import{H as be}from"./heading-small-RmHd5nK4.js";import{B as n}from"./button-DttS-hSO.js";import{C as $,a as q,b as G,c as K,d as Ie,e as Q}from"./card-DfQq8xjq.js";import{B as W}from"./badge-CZj20M3O.js";import{I as B}from"./input-KN5y_tmq.js";import{L as T}from"./label-CLHv5EXU.js";import{T as Se,a as Ne,b as X,c as Z}from"./tabs-PByZcPwl.js";import{D as g,a as we,b as f,c as C,d as y,e as b,f as I}from"./dialog-BIHROgrG.js";import{A as Re}from"./app-layout-D8Tf8JSL.js";import{S as De}from"./layout-CMm98njd.js";/* empty css            */import"./utils-DawFQoOT.js";import"./index-C6YWzjxw.js";import"./index-kZDZBK9R.js";import"./index-DpFxWXhO.js";import"./index-DVPqwmDN.js";import"./index-DH27nmtP.js";import"./index-JB8FLK9q.js";import"./index-D2xyTu0-.js";import"./index-BS1oCJ0R.js";import"./index-DB97fau_.js";import"./x-C_zQvMCL.js";import"./createLucideIcon-B8-QgQ2g.js";import"./breadcrumb-B0lOsGUr.js";import"./sheet-BQ7ZHeJH.js";import"./index-KBPR2gxA.js";import"./index-D-MPqe8D.js";import"./index-g_lpINMr.js";import"./dropdown-menu-C44z3VEl.js";import"./check-o4IyhQhV.js";import"./file-text-DJz8nwxt.js";import"./users-DqaIzH7r.js";import"./package-famJlHsI.js";import"./wallet-1YY19SXz.js";import"./chevron-down-DjDlq31K.js";import"./skeleton-C1cSm2kL.js";import"./use-effective-tenant-it7FmrhR.js";import"./trash-2-CBlWZpKk.js";import"./en-US-DSSwd-Ay.js";import"./endOfMonth-BNqLjwTF.js";import"./user-C3DA-HUB.js";import"./dollar-sign-CtwrfOoy.js";import"./credit-card-BBEokihX.js";import"./mail-DQFl-2hO.js";import"./shield-SUW6F_AQ.js";import"./circle-alert-DSmqB_aB.js";import"./building-2-ClZdYFLS.js";import"./chevron-right-BFzkFd6A.js";import"./sonner-B0HlpBLA.js";import"./separator-GwQSQCOi.js";import"./user-plus-PCQ9TCZ1.js";import"./key-round-BHbt2YCZ.js";import"./history-CKeWRQ3Z.js";const ze=[{title:"Organization",href:"/settings/organization"},{title:"People",href:"/settings/organization/people"}];function As({members:Y,invites:k,userRole:S}){const h=ye(),{auth:p}=fe().props,[ee,M]=i.useState(!1),[se,N]=i.useState(!1),[ne,w]=i.useState(!1),[ie,R]=i.useState(!1),[re,D]=i.useState(!1),[r,A]=i.useState(null),[x,O]=i.useState(null),[o,j]=i.useState(null),[m,z]=i.useState(null),[c,v]=i.useState({email:"",role:"member"}),[L,u]=i.useState(""),F=S==="owner"||S==="admin",te=S==="owner"||S==="admin",[E,ae]=i.useState(""),[P,le]=i.useState("all"),[U,oe]=i.useState(""),[H,ce]=i.useState("all"),J=Y.filter(s=>{const d=s.name.toLowerCase().includes(E.toLowerCase())||s.email.toLowerCase().includes(E.toLowerCase()),t=P==="all"||s.role===P;return d&&t}),V=k.filter(s=>{const d=s.email.toLowerCase().includes(U.toLowerCase()),t=H==="all"||s.status===H;return d&&t}),de=()=>{if(u(""),c.email.toLowerCase()===p.user.email.toLowerCase()){u("You can't invite yourself to the organization");return}if(k.some(t=>t.email.toLowerCase()===c.email.toLowerCase()&&t.status==="pending")){k.find(t=>t.email.toLowerCase()===c.email.toLowerCase()&&t.status==="pending"),u("This person already has a pending invitation. You can either resend the existing invite or cancel it and send a new one.");return}if(Y.some(t=>t.email.toLowerCase()===c.email.toLowerCase())){u("This person is already a member of the organization");return}l.post(h.route("settings.organization.invites.send"),c,{onSuccess:()=>{a.success("Invite sent successfully"),M(!1),v({email:"",role:"member"}),u("")},onError:t=>{a.error(t.email||"Failed to send invite")}})},me=s=>{l.post(h.route("settings.organization.invites.cancel",{invite:s}),{},{onSuccess:()=>{a.success("Invite cancelled successfully"),N(!1),A(null),l.reload()},onError:()=>{a.error("Failed to cancel invite")}})},ue=s=>{l.post(h.route("settings.organization.invites.resend",{invite:s}),{},{onSuccess:()=>{a.success("Invite resent successfully"),w(!1),O(null)},onError:()=>{a.error("Failed to resend invite")}})},he=s=>{l.post(h.route("tenants.invites.accept",{invite:s}),{},{onSuccess:()=>{a.success("Invite accepted successfully"),l.reload()},onError:d=>{a.error(d.message||"Failed to accept invite")}})},_=s=>{A({id:s.id,email:s.email,isInvitee:s.email===p.user.email}),N(!0)},pe=s=>{O({id:s.id,email:s.email}),w(!0)},xe=()=>{o&&l.post(h.route("settings.organization.members.update-role",{member:o.id}),{role:o.currentRole},{onSuccess:()=>{a.success("Role updated successfully"),R(!1),j(null),l.reload()},onError:s=>{a.error(s.role||"Failed to update role")}})},je=s=>{j({id:s.id,email:s.email,currentRole:s.role}),R(!0)},ve=()=>{m&&l.post(h.route("settings.organization.members.remove",{member:m.id}),{},{onSuccess:()=>{a.success("Member removed successfully"),D(!1),z(null),l.reload()},onError:s=>{a.error(s.member||"Failed to remove member")}})},ge=s=>{z({id:s.id,name:s.name,email:s.email}),D(!0)};return e.jsxs(Re,{breadcrumbs:ze,children:[e.jsx(Ce,{title:"Organization People"}),e.jsx(De,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(be,{title:"People",description:"Manage your organization members and invites"}),F&&e.jsxs(g,{open:ee,onOpenChange:s=>{M(s),s||(v({email:"",role:"member"}),u(""))},children:[e.jsx(we,{asChild:!0,children:e.jsx(n,{children:"Invite People"})}),e.jsxs(f,{children:[e.jsxs(C,{children:[e.jsx(y,{children:"Invite to Organization"}),e.jsx(b,{children:"Send an invitation to join your organization."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"email",children:"Email"}),e.jsx(B,{id:"email",type:"email",placeholder:"colleague@company.com",value:c.email,onChange:s=>{v({...c,email:s.target.value}),u("")},className:L?"border-destructive":""}),L&&e.jsx("p",{className:"text-sm text-destructive",children:L})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"role",children:"Role"}),e.jsxs("select",{id:"role",value:c.role,onChange:s=>v({...c,role:s.target.value}),className:"w-full rounded-md border border-input bg-background px-3 py-2",children:[e.jsx("option",{value:"member",children:"Member"}),e.jsx("option",{value:"editor",children:"Editor"}),e.jsx("option",{value:"admin",children:"Admin"})]})]})]}),e.jsxs(I,{children:[e.jsx(n,{variant:"outline",onClick:()=>{M(!1),v({email:"",role:"member"}),u("")},children:"Cancel"}),e.jsx(n,{onClick:de,children:"Send Invite"})]})]})]})]}),e.jsx(g,{open:se,onOpenChange:N,children:e.jsxs(f,{children:[e.jsxs(C,{children:[e.jsx(y,{children:r!=null&&r.isInvitee?"Decline Invite":"Cancel Invite"}),e.jsx(b,{children:r!=null&&r.isInvitee?"Are you sure you want to decline this invitation? This action cannot be undone.":`Are you sure you want to cancel the invitation for ${r==null?void 0:r.email}? This action cannot be undone.`})]}),e.jsxs(I,{children:[e.jsx(n,{variant:"outline",onClick:()=>{N(!1),A(null)},children:"No, keep it"}),e.jsx(n,{variant:"destructive",onClick:()=>r&&me(r.id),children:r!=null&&r.isInvitee?"Yes, decline":"Yes, cancel"})]})]})}),e.jsx(g,{open:ne,onOpenChange:w,children:e.jsxs(f,{children:[e.jsxs(C,{children:[e.jsx(y,{children:"Resend Invite"}),e.jsxs(b,{children:["Are you sure you want to resend the invitation to ",x==null?void 0:x.email,"?"]})]}),e.jsxs(I,{children:[e.jsx(n,{variant:"outline",onClick:()=>{w(!1),O(null)},children:"No, cancel"}),e.jsx(n,{onClick:()=>x&&ue(x.id),children:"Yes, resend"})]})]})}),e.jsx(g,{open:ie,onOpenChange:s=>{R(s),s||j(null)},children:e.jsxs(f,{children:[e.jsxs(C,{children:[e.jsx(y,{children:"Change Member Role"}),e.jsxs(b,{children:["Update the role for ",o==null?void 0:o.email]})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"role",children:"Role"}),e.jsxs("select",{id:"role",value:o==null?void 0:o.currentRole,onChange:s=>j(d=>d?{...d,currentRole:s.target.value}:null),className:"w-full rounded-md border border-input bg-background px-3 py-2",children:[e.jsx("option",{value:"member",children:"Member"}),e.jsx("option",{value:"editor",children:"Editor"}),e.jsx("option",{value:"admin",children:"Admin"})]})]})}),e.jsxs(I,{children:[e.jsx(n,{variant:"outline",onClick:()=>{R(!1),j(null)},children:"Cancel"}),e.jsx(n,{onClick:xe,children:"Update Role"})]})]})}),e.jsx(g,{open:re,onOpenChange:s=>{D(s),s||z(null)},children:e.jsxs(f,{children:[e.jsxs(C,{children:[e.jsx(y,{children:"Remove Member"}),e.jsxs(b,{children:["Are you sure you want to remove ",m==null?void 0:m.name," (",m==null?void 0:m.email,") from the organization? This action cannot be undone."]})]}),e.jsxs(I,{children:[e.jsx(n,{variant:"outline",onClick:()=>{D(!1),z(null)},children:"Cancel"}),e.jsx(n,{variant:"destructive",onClick:ve,children:"Remove Member"})]})]})}),e.jsxs(Se,{defaultValue:"members",className:"space-y-6",children:[e.jsxs(Ne,{children:[e.jsx(X,{value:"members",children:"Members"}),F&&e.jsx(X,{value:"invites",children:"Pending Invites"})]}),e.jsxs(Z,{value:"members",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(B,{type:"search",placeholder:"Search members...",className:"w-full",value:E,onChange:s=>ae(s.target.value)})}),e.jsxs("select",{className:"rounded-md border border-input bg-background px-3 py-2",value:P,onChange:s=>le(s.target.value),children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"owner",children:"Owners"}),e.jsx("option",{value:"admin",children:"Admins"}),e.jsx("option",{value:"editor",children:"Editors"}),e.jsx("option",{value:"member",children:"Members"})]})]}),e.jsxs("div",{className:"grid gap-4",children:[J.map(s=>e.jsxs($,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-2xl",children:s.avatar}),e.jsxs("div",{children:[e.jsx(G,{children:s.name}),e.jsx(K,{children:s.email})]})]}),e.jsx(W,{variant:s.role==="owner"?"default":s.role==="admin"||s.role==="editor"?"secondary":"outline",children:s.role?s.role.charAt(0).toUpperCase()+s.role.slice(1):"Member"})]})}),e.jsx(Ie,{children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Joined ",s.joinedAt]})}),te&&e.jsxs(Q,{children:[s.email!==p.user.email&&e.jsx(n,{variant:"outline",size:"sm",onClick:()=>je(s),children:"Change Role"}),s.role!=="owner"&&s.email!==p.user.email&&e.jsx(n,{variant:"destructive",size:"sm",className:"ml-2",onClick:()=>ge(s),children:"Remove"})]})]},s.id)),J.length===0&&e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No members found matching your search criteria"})]})]}),F&&e.jsxs(Z,{value:"invites",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(B,{type:"search",placeholder:"Search invites...",className:"w-full",value:U,onChange:s=>oe(s.target.value)})}),e.jsxs("select",{className:"rounded-md border border-input bg-background px-3 py-2",value:H,onChange:s=>ce(s.target.value),children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"accepted",children:"Accepted"}),e.jsx("option",{value:"expired",children:"Expired"})]})]}),e.jsxs("div",{className:"grid gap-4",children:[V.map(s=>e.jsxs($,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{children:s.email}),e.jsxs(K,{children:["Invited by ",s.invitedBy," â€¢ ",s.invitedAt]})]}),e.jsx(W,{variant:"outline",children:s.role.charAt(0).toUpperCase()+s.role.slice(1)})]})}),e.jsx(Q,{className:"flex gap-2",children:s.status==="pending"&&e.jsx(e.Fragment,{children:s.email===p.user.email?e.jsxs(e.Fragment,{children:[e.jsx(n,{size:"sm",onClick:()=>he(s.id),children:"Accept Invite"}),e.jsx(n,{variant:"destructive",size:"sm",onClick:()=>_(s),children:"Decline"})]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>pe(s),children:"Resend Invite"}),e.jsx(n,{variant:"destructive",size:"sm",onClick:()=>_(s),children:"Cancel Invite"})]})})})]},s.id)),V.length===0&&e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No invites found matching your search criteria"})]})]})]})]})})]})}export{As as default};
