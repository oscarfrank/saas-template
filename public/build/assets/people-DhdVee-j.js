import{b as fe,r as i,j as e,H as Ce,a as l}from"./app-Bw_eO3sd.js";import{t as a}from"./index-De6LdJTA.js";import{u as ye}from"./use-tenant-router-BPEgyWCx.js";import{S as be,H as Ie}from"./layout-D2U6Oeb8.js";import{B as n}from"./button-DY2O9S9G.js";import{C as $,a as q,b as G,d as K,c as Se,e as Q}from"./card-DFDYEeIO.js";import{B as W}from"./badge-DPU-7Oq6.js";import{I as B}from"./input-Bmbc7aO-.js";import{L as T}from"./label-C8ywGR50.js";import{T as Ne,a as we,b as X,c as Z}from"./tabs-Btb8IMYr.js";import{D as g,a as Re,b as f,c as C,d as y,e as b,f as I}from"./dialog-DXDwBKs7.js";import{A as De}from"./app-layout-BSIvknne.js";/* empty css            */import"./separator-Cb5U1186.js";import"./utils-DawFQoOT.js";import"./use-effective-tenant-DB7mi6AU.js";import"./user-DQDpUZmM.js";import"./createLucideIcon-B9LDe1F7.js";import"./shield-BPzbhB4h.js";import"./breadcrumb-C2sRCkcu.js";import"./sheet-CmXTK4FQ.js";import"./index-ByXzH8er.js";import"./index-BUUDosUt.js";import"./index-CVZ3wJAA.js";import"./index-fLpoMwuJ.js";import"./index-CtNM4qhv.js";import"./index-NSo7goI1.js";import"./index-KPETvMeP.js";import"./x-BbsTXzvW.js";import"./index-V7Tq7z7Y.js";import"./index-VORSUaQ4.js";import"./index-U92boKRB.js";import"./dropdown-menu-eFqcjt66.js";import"./index-Bt6kV37t.js";import"./index-BG0SbQBQ.js";import"./check-DWqh-ITp.js";import"./chevron-down-1laKfkfM.js";import"./skeleton-COevZx66.js";import"./trash-2-CEE_VqOF.js";import"./en-US-DSSwd-Ay.js";import"./endOfMonth-BNqLjwTF.js";import"./file-text-DPljHKaA.js";import"./dollar-sign-BdaYzWQe.js";import"./credit-card-8AiVb87_.js";import"./mail-FVHvQLZC.js";import"./circle-alert-BvybSHRd.js";import"./package-D6uMvGvA.js";import"./users-BpArtZsm.js";import"./wallet-Cnkdu3fg.js";import"./building-2-DJOAXm0m.js";import"./chevron-right-BXZknpZE.js";import"./user-plus-GCPwClXN.js";import"./key-round-DI5m9l5K.js";import"./history-9adb-II8.js";import"./sonner--M2gOl5q.js";const ze=[{title:"Organization",href:"/settings/organization"},{title:"People",href:"/settings/organization/people"}];function Ms({members:Y,invites:k,userRole:S}){const h=ye(),{auth:p}=fe().props,[ee,M]=i.useState(!1),[se,N]=i.useState(!1),[ne,w]=i.useState(!1),[ie,R]=i.useState(!1),[te,D]=i.useState(!1),[t,A]=i.useState(null),[x,O]=i.useState(null),[o,j]=i.useState(null),[m,z]=i.useState(null),[c,v]=i.useState({email:"",role:"member"}),[L,u]=i.useState(""),F=S==="owner"||S==="admin",re=S==="owner"||S==="admin",[E,ae]=i.useState(""),[P,le]=i.useState("all"),[U,oe]=i.useState(""),[H,ce]=i.useState("all"),J=Y.filter(s=>{const d=s.name.toLowerCase().includes(E.toLowerCase())||s.email.toLowerCase().includes(E.toLowerCase()),r=P==="all"||s.role===P;return d&&r}),V=k.filter(s=>{const d=s.email.toLowerCase().includes(U.toLowerCase()),r=H==="all"||s.status===H;return d&&r}),de=()=>{if(u(""),c.email.toLowerCase()===p.user.email.toLowerCase()){u("You can't invite yourself to the organization");return}if(k.some(r=>r.email.toLowerCase()===c.email.toLowerCase()&&r.status==="pending")){k.find(r=>r.email.toLowerCase()===c.email.toLowerCase()&&r.status==="pending"),u("This person already has a pending invitation. You can either resend the existing invite or cancel it and send a new one.");return}if(Y.some(r=>r.email.toLowerCase()===c.email.toLowerCase())){u("This person is already a member of the organization");return}l.post(h.route("settings.organization.invites.send"),c,{onSuccess:()=>{a.success("Invite sent successfully"),M(!1),v({email:"",role:"member"}),u("")},onError:r=>{a.error(r.email||"Failed to send invite")}})},me=s=>{l.post(h.route("settings.organization.invites.cancel",{invite:s}),{},{onSuccess:()=>{a.success("Invite cancelled successfully"),N(!1),A(null),l.reload()},onError:()=>{a.error("Failed to cancel invite")}})},ue=s=>{l.post(h.route("settings.organization.invites.resend",{invite:s}),{},{onSuccess:()=>{a.success("Invite resent successfully"),w(!1),O(null)},onError:()=>{a.error("Failed to resend invite")}})},he=s=>{l.post(h.route("tenants.invites.accept",{invite:s}),{},{onSuccess:()=>{a.success("Invite accepted successfully"),l.reload()},onError:d=>{a.error(d.message||"Failed to accept invite")}})},_=s=>{A({id:s.id,email:s.email,isInvitee:s.email===p.user.email}),N(!0)},pe=s=>{O({id:s.id,email:s.email}),w(!0)},xe=()=>{o&&l.post(h.route("settings.organization.members.update-role",{member:o.id}),{role:o.currentRole},{onSuccess:()=>{a.success("Role updated successfully"),R(!1),j(null),l.reload()},onError:s=>{a.error(s.role||"Failed to update role")}})},je=s=>{j({id:s.id,email:s.email,currentRole:s.role}),R(!0)},ve=()=>{m&&l.post(h.route("settings.organization.members.remove",{member:m.id}),{},{onSuccess:()=>{a.success("Member removed successfully"),D(!1),z(null),l.reload()},onError:s=>{a.error(s.member||"Failed to remove member")}})},ge=s=>{z({id:s.id,name:s.name,email:s.email}),D(!0)};return e.jsxs(De,{breadcrumbs:ze,children:[e.jsx(Ce,{title:"Organization People"}),e.jsx(be,{children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Ie,{title:"People",description:"Manage your organization members and invites"}),F&&e.jsxs(g,{open:ee,onOpenChange:s=>{M(s),s||(v({email:"",role:"member"}),u(""))},children:[e.jsx(Re,{asChild:!0,children:e.jsx(n,{children:"Invite People"})}),e.jsxs(f,{children:[e.jsxs(C,{children:[e.jsx(y,{children:"Invite to Organization"}),e.jsx(b,{children:"Send an invitation to join your organization."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"email",children:"Email"}),e.jsx(B,{id:"email",type:"email",placeholder:"colleague@company.com",value:c.email,onChange:s=>{v({...c,email:s.target.value}),u("")},className:L?"border-destructive":""}),L&&e.jsx("p",{className:"text-sm text-destructive",children:L})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"role",children:"Role"}),e.jsxs("select",{id:"role",value:c.role,onChange:s=>v({...c,role:s.target.value}),className:"w-full rounded-md border border-input bg-background px-3 py-2",children:[e.jsx("option",{value:"member",children:"Member"}),e.jsx("option",{value:"editor",children:"Editor"}),e.jsx("option",{value:"admin",children:"Admin"})]})]})]}),e.jsxs(I,{children:[e.jsx(n,{variant:"outline",onClick:()=>{M(!1),v({email:"",role:"member"}),u("")},children:"Cancel"}),e.jsx(n,{onClick:de,children:"Send Invite"})]})]})]})]}),e.jsx(g,{open:se,onOpenChange:N,children:e.jsxs(f,{children:[e.jsxs(C,{children:[e.jsx(y,{children:t!=null&&t.isInvitee?"Decline Invite":"Cancel Invite"}),e.jsx(b,{children:t!=null&&t.isInvitee?"Are you sure you want to decline this invitation? This action cannot be undone.":`Are you sure you want to cancel the invitation for ${t==null?void 0:t.email}? This action cannot be undone.`})]}),e.jsxs(I,{children:[e.jsx(n,{variant:"outline",onClick:()=>{N(!1),A(null)},children:"No, keep it"}),e.jsx(n,{variant:"destructive",onClick:()=>t&&me(t.id),children:t!=null&&t.isInvitee?"Yes, decline":"Yes, cancel"})]})]})}),e.jsx(g,{open:ne,onOpenChange:w,children:e.jsxs(f,{children:[e.jsxs(C,{children:[e.jsx(y,{children:"Resend Invite"}),e.jsxs(b,{children:["Are you sure you want to resend the invitation to ",x==null?void 0:x.email,"?"]})]}),e.jsxs(I,{children:[e.jsx(n,{variant:"outline",onClick:()=>{w(!1),O(null)},children:"No, cancel"}),e.jsx(n,{onClick:()=>x&&ue(x.id),children:"Yes, resend"})]})]})}),e.jsx(g,{open:ie,onOpenChange:s=>{R(s),s||j(null)},children:e.jsxs(f,{children:[e.jsxs(C,{children:[e.jsx(y,{children:"Change Member Role"}),e.jsxs(b,{children:["Update the role for ",o==null?void 0:o.email]})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"role",children:"Role"}),e.jsxs("select",{id:"role",value:o==null?void 0:o.currentRole,onChange:s=>j(d=>d?{...d,currentRole:s.target.value}:null),className:"w-full rounded-md border border-input bg-background px-3 py-2",children:[e.jsx("option",{value:"member",children:"Member"}),e.jsx("option",{value:"editor",children:"Editor"}),e.jsx("option",{value:"admin",children:"Admin"})]})]})}),e.jsxs(I,{children:[e.jsx(n,{variant:"outline",onClick:()=>{R(!1),j(null)},children:"Cancel"}),e.jsx(n,{onClick:xe,children:"Update Role"})]})]})}),e.jsx(g,{open:te,onOpenChange:s=>{D(s),s||z(null)},children:e.jsxs(f,{children:[e.jsxs(C,{children:[e.jsx(y,{children:"Remove Member"}),e.jsxs(b,{children:["Are you sure you want to remove ",m==null?void 0:m.name," (",m==null?void 0:m.email,") from the organization? This action cannot be undone."]})]}),e.jsxs(I,{children:[e.jsx(n,{variant:"outline",onClick:()=>{D(!1),z(null)},children:"Cancel"}),e.jsx(n,{variant:"destructive",onClick:ve,children:"Remove Member"})]})]})}),e.jsxs(Ne,{defaultValue:"members",className:"space-y-6",children:[e.jsxs(we,{children:[e.jsx(X,{value:"members",children:"Members"}),F&&e.jsx(X,{value:"invites",children:"Pending Invites"})]}),e.jsxs(Z,{value:"members",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(B,{type:"search",placeholder:"Search members...",className:"w-full",value:E,onChange:s=>ae(s.target.value)})}),e.jsxs("select",{className:"rounded-md border border-input bg-background px-3 py-2",value:P,onChange:s=>le(s.target.value),children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"owner",children:"Owners"}),e.jsx("option",{value:"admin",children:"Admins"}),e.jsx("option",{value:"editor",children:"Editors"}),e.jsx("option",{value:"member",children:"Members"})]})]}),e.jsxs("div",{className:"grid gap-4",children:[J.map(s=>e.jsxs($,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-2xl",children:s.avatar}),e.jsxs("div",{children:[e.jsx(G,{children:s.name}),e.jsx(K,{children:s.email})]})]}),e.jsx(W,{variant:s.role==="owner"?"default":s.role==="admin"||s.role==="editor"?"secondary":"outline",children:s.role?s.role.charAt(0).toUpperCase()+s.role.slice(1):"Member"})]})}),e.jsx(Se,{children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Joined ",s.joinedAt]})}),re&&e.jsxs(Q,{children:[s.email!==p.user.email&&e.jsx(n,{variant:"outline",size:"sm",onClick:()=>je(s),children:"Change Role"}),s.role!=="owner"&&s.email!==p.user.email&&e.jsx(n,{variant:"destructive",size:"sm",className:"ml-2",onClick:()=>ge(s),children:"Remove"})]})]},s.id)),J.length===0&&e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No members found matching your search criteria"})]})]}),F&&e.jsxs(Z,{value:"invites",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(B,{type:"search",placeholder:"Search invites...",className:"w-full",value:U,onChange:s=>oe(s.target.value)})}),e.jsxs("select",{className:"rounded-md border border-input bg-background px-3 py-2",value:H,onChange:s=>ce(s.target.value),children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"accepted",children:"Accepted"}),e.jsx("option",{value:"expired",children:"Expired"})]})]}),e.jsxs("div",{className:"grid gap-4",children:[V.map(s=>e.jsxs($,{children:[e.jsx(q,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{children:s.email}),e.jsxs(K,{children:["Invited by ",s.invitedBy," â€¢ ",s.invitedAt]})]}),e.jsx(W,{variant:"outline",children:s.role.charAt(0).toUpperCase()+s.role.slice(1)})]})}),e.jsx(Q,{className:"flex gap-2",children:s.status==="pending"&&e.jsx(e.Fragment,{children:s.email===p.user.email?e.jsxs(e.Fragment,{children:[e.jsx(n,{size:"sm",onClick:()=>he(s.id),children:"Accept Invite"}),e.jsx(n,{variant:"destructive",size:"sm",onClick:()=>_(s),children:"Decline"})]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>pe(s),children:"Resend Invite"}),e.jsx(n,{variant:"destructive",size:"sm",onClick:()=>_(s),children:"Cancel Invite"})]})})})]},s.id)),V.length===0&&e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No invites found matching your search criteria"})]})]})]})]})})]})}export{Ms as default};
