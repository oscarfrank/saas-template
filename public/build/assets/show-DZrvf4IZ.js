import{r as n,a as m,j as e,H as fe,L as x}from"./app-C6kPN11i.js";import{A as be}from"./app-layout-D7Ym20yP.js";import{B as c}from"./button-BpcDdXY5.js";import{C as U,d as P,a as ve}from"./card-BmLtWeUg.js";import{A as Ne}from"./asset-status-badge-DxyWB9Ov.js";import{C as Z}from"./checkbox-CshTKHSY.js";import{u as _e}from"./use-tenant-router-DTqtlbGV.js";import{S as V,a as F,b as E,c as R,d as N}from"./select-Ccun-8aA.js";import{A as L,a as H,b as $,c as q,d as G,e as J,f as K,g as M}from"./alert-dialog-Dxf_TM7l.js";import{I as we}from"./input-DeRGwPqG.js";import{F as Ce}from"./folder-tree-k2os41Gx.js";import{P as ee}from"./pencil-DyR_OX_m.js";import{T as Q}from"./trash-2-CxGNVkTA.js";import{U as ye}from"./user-plus-C3KzTetM.js";import{S as Se}from"./search-CWaXE8zD.js";import{A as C,a as y}from"./arrow-up-QrIuVaY-.js";import{A as S}from"./arrow-up-down-DWNpiqBS.js";import{C as ke}from"./chevron-left-BLoEphdw.js";import{C as Ae}from"./chevron-right-DDsMzLk9.js";import{P as ze}from"./package-BxdLO7jd.js";/* empty css            */import"./breadcrumb-T3ZEscMa.js";import"./utils-DawFQoOT.js";import"./sheet-DTohGHug.js";import"./index-BAMDKCYP.js";import"./index-BgupMaT4.js";import"./index-BAwu540p.js";import"./index-B6IO7GeI.js";import"./index-C7NICwH1.js";import"./index-D4LQi-WW.js";import"./index-BUDeVy67.js";import"./x-CBDS_5l3.js";import"./createLucideIcon-Btrq-JEB.js";import"./index-qNm-4KWi.js";import"./index-DjhqQPoh.js";import"./index-DhnENxrq.js";import"./dropdown-menu-D3Uldfay.js";import"./index-CNSJNdLA.js";import"./index-DqvV1WAh.js";import"./check-ClCxYYgj.js";import"./chevron-down-B2X-k1Lh.js";import"./skeleton-COOtXclS.js";import"./use-effective-tenant-BWuu0ab1.js";import"./en-US-DSSwd-Ay.js";import"./endOfMonth-BNqLjwTF.js";import"./user-B4Zct4sF.js";import"./file-text-Dt63_vzy.js";import"./dollar-sign-B1EcXlzZ.js";import"./credit-card-DqGQHV60.js";import"./mail-CxIpkxxd.js";import"./shield-JlQ_48fz.js";import"./circle-alert-CphltCJl.js";import"./users-Hp18PoY4.js";import"./wallet-Rygk2Esi.js";import"./building-2-BJ5JnpgN.js";import"./sonner-Dk1iPVCY.js";import"./index-BdMXpxBe.js";import"./badge-CU1YL7MN.js";import"./index-DHeuMB84.js";function se(t,o){if(t==null||t==="")return"—";const k=parseFloat(t);return new Intl.NumberFormat(void 0,{style:"currency",currency:o||"USD"}).format(k)}function Us({category:t,assets:o,categories:k=[],users:te=[],statusOptions:W={},filters:a={}}){const r=_e(),[i,u]=n.useState(new Set),[j,A]=n.useState(""),[g,z]=n.useState(""),[f,D]=n.useState(""),[B,T]=n.useState(null),[ae,O]=n.useState(!1),[re,X]=n.useState(!1),Y=n.useRef(null),b=o.data.map(s=>s.uuid),I=b.length>0&&b.every(s=>i.has(s)),le=i.size>0,ne=n.useCallback(s=>{u(l=>{const d=new Set(l);return d.has(s)?d.delete(s):d.add(s),d})},[]),ie=n.useCallback(()=>{u(I?s=>{const l=new Set(s);return b.forEach(d=>l.delete(d)),l}:s=>{const l=new Set(s);return b.forEach(d=>l.add(d)),l})},[I,b]),ce=n.useCallback(()=>{u(new Set),A(""),z(""),D("")},[]),oe=n.useCallback(()=>{i.size!==0&&O(!0)},[i.size]),de=n.useCallback(()=>{m.post(r.route("assets.bulk-destroy"),{uuids:Array.from(i)},{preserveScroll:!0,onSuccess:()=>{u(new Set),O(!1)}})},[i,r]),ue=n.useCallback(()=>{i.size===0||!g||m.post(r.route("assets.bulk-update-status"),{uuids:Array.from(i),status:g},{preserveScroll:!0,onSuccess:()=>{u(new Set),z("")}})},[i,g,r]),me=n.useCallback(()=>{if(i.size===0)return;const s=f===""||f==="__none__"?"":f;m.post(r.route("assets.bulk-update-assigned-to"),{uuids:Array.from(i),assigned_to_user_id:s||null},{preserveScroll:!0,onSuccess:()=>{u(new Set),D("")}})},[i,f,r]),xe=n.useCallback(()=>{if(i.size===0)return;const s=j===""||j==="__uncategorized__"?null:j;m.post(r.route("assets.bulk-update-category"),{uuids:Array.from(i),asset_category_id:s},{preserveScroll:!0,onSuccess:()=>{u(new Set),A("")}})},[i,j,r]),he=[{title:"Assets",href:r.route("assets.index")},{title:"Categories",href:r.route("assets.categories.index")},{title:t.name,href:r.route("assets.categories.show",{category:t.id})}],_=s=>!s||Object.keys(s).length===0?"—":Object.entries(s).filter(([,l])=>Number(l)>0).map(([l,d])=>se(String(d),l)).join(" · "),pe=s=>[s.first_name,s.last_name].filter(Boolean).join(" ")||s.email,je=n.useCallback(()=>{m.delete(r.route("assets.categories.destroy",{category:t.id}),{preserveScroll:!0,onSuccess:()=>m.visit(r.route("assets.categories.index"))})},[t.id,r]),ge=n.useCallback(()=>{var l,d;const s=(d=(l=Y.current)==null?void 0:l.value)==null?void 0:d.trim();r.get("assets.categories.show",{category:t.id,search:s||void 0,status:a.status==="all"?void 0:a.status,sort:a.sort||void 0,dir:a.dir||void 0,page:void 0},{preserveScroll:!0})},[t.id,a.status,a.sort,a.dir,r]),h=(a.dir??"asc").toLowerCase(),p=a.sort??"name",w=n.useCallback(s=>{const l=p===s&&h==="asc"?"desc":"asc";r.get("assets.categories.show",{category:t.id,search:a.search||void 0,status:a.status==="all"?void 0:a.status,sort:s,dir:l,page:void 0},{preserveScroll:!0})},[t.id,p,h,a.search,a.status,r]),v=n.useCallback(s=>{r.get("assets.categories.show",{category:t.id,search:a.search||void 0,status:s==="all"?void 0:s,sort:a.sort||void 0,dir:a.dir||void 0,page:void 0},{preserveScroll:!0})},[t.id,a.search,a.sort,a.dir,r]);return e.jsxs(be,{breadcrumbs:he,children:[e.jsx(fe,{title:t.name}),e.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-primary/10",children:e.jsx(Ce,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:t.name}),t.description&&e.jsx("p",{className:"text-muted-foreground text-sm",children:t.description})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(x,{href:r.route("assets.categories.edit",{category:t.id}),children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Edit"]})}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>X(!0),className:"text-destructive hover:text-destructive",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]}),le&&e.jsxs("div",{className:"flex flex-wrap items-center gap-3 rounded-lg border bg-muted/40 px-4 py-2",children:[e.jsxs("span",{className:"text-sm font-medium",children:[i.size," selected"]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(V,{value:j||"__none__",onValueChange:s=>A(s==="__none__"?"":s),children:[e.jsx(F,{className:"h-9 w-[200px]",children:e.jsx(E,{placeholder:"Category..."})}),e.jsxs(R,{children:[e.jsx(N,{value:"__uncategorized__",children:"Uncategorized"}),k.map(s=>e.jsx(N,{value:String(s.id),children:s.name},s.id))]})]}),e.jsx(c,{variant:"secondary",size:"sm",onClick:xe,children:"Assign category"}),e.jsxs(V,{value:g||"__none__",onValueChange:s=>z(s==="__none__"?"":s),children:[e.jsx(F,{className:"h-9 w-[180px]",children:e.jsx(E,{placeholder:"Status..."})}),e.jsx(R,{children:Object.entries(W).map(([s,l])=>e.jsx(N,{value:s,children:l},s))})]}),e.jsx(c,{variant:"secondary",size:"sm",onClick:ue,disabled:!g,children:"Assign status"}),e.jsxs(V,{value:f||"__none__",onValueChange:s=>D(s==="__none__"?"":s),children:[e.jsx(F,{className:"h-9 w-[200px]",children:e.jsx(E,{placeholder:"Assigned to..."})}),e.jsxs(R,{children:[e.jsx(N,{value:"__none__",children:"Unassigned"}),te.map(s=>e.jsx(N,{value:String(s.id),children:[s.first_name,s.last_name].filter(Boolean).join(" ")||s.email},s.id))]})]}),e.jsxs(c,{variant:"secondary",size:"sm",onClick:me,children:[e.jsx(ye,{className:"h-4 w-4 mr-1"}),"Assign to"]})]}),e.jsxs(c,{variant:"destructive",size:"sm",onClick:oe,children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Delete selected"]}),e.jsx(c,{variant:"ghost",size:"sm",onClick:ce,children:"Clear selection"})]}),e.jsx(L,{open:ae,onOpenChange:O,children:e.jsxs(H,{children:[e.jsxs($,{children:[e.jsx(q,{children:"Delete selected assets?"}),e.jsxs(G,{children:["This will permanently delete ",i.size," asset",i.size!==1?"s":"",". This cannot be undone."]})]}),e.jsxs(J,{children:[e.jsx(K,{children:"Cancel"}),e.jsx(M,{onClick:de,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})}),e.jsx(L,{open:!!B,onOpenChange:s=>!s&&T(null),children:e.jsxs(H,{children:[e.jsxs($,{children:[e.jsx(q,{children:"Delete this asset?"}),e.jsx(G,{children:"This cannot be undone."})]}),e.jsxs(J,{children:[e.jsx(K,{children:"Cancel"}),e.jsx(M,{onClick:()=>{B&&m.delete(r.route("assets.destroy",{asset:B}),{preserveScroll:!0,onSuccess:()=>T(null)})},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})}),e.jsx(L,{open:re,onOpenChange:X,children:e.jsxs(H,{children:[e.jsxs($,{children:[e.jsx(q,{children:"Delete this category?"}),e.jsx(G,{children:"Assets in this category will become uncategorized. This cannot be undone."})]}),e.jsxs(J,{children:[e.jsx(K,{children:"Cancel"}),e.jsx(M,{onClick:je,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(U,{className:"overflow-hidden rounded-2xl border shadow-sm",children:e.jsxs(P,{className:"pt-5 pb-5",children:[e.jsx("p",{className:"text-muted-foreground text-sm font-medium mb-4",children:"Summary"}),e.jsxs("dl",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-baseline gap-2",children:[e.jsx("dt",{className:"text-muted-foreground text-sm",children:"Total items"}),e.jsx("dd",{className:"text-xl font-semibold tabular-nums",children:t.total_in_category??0})]}),e.jsxs("div",{className:"flex justify-between items-baseline gap-2",children:[e.jsx("dt",{className:"text-muted-foreground text-sm",children:"Available"}),e.jsx("dd",{className:"text-xl font-semibold tabular-nums",children:t.available_assets_count??0})]}),e.jsxs("div",{className:"flex justify-between items-baseline gap-2",children:[e.jsx("dt",{className:"text-muted-foreground text-sm",children:"Available for sale"}),e.jsx("dd",{className:"text-xl font-semibold tabular-nums",children:t.available_for_sale_count??0})]}),e.jsxs("div",{className:"flex justify-between items-baseline gap-2",children:[e.jsx("dt",{className:"text-muted-foreground text-sm",children:"Sold"}),e.jsx("dd",{className:"text-xl font-semibold tabular-nums",children:t.sold_count??0})]})]})]})}),e.jsx(U,{className:"overflow-hidden rounded-2xl border shadow-sm",children:e.jsxs(P,{className:"pt-5 pb-5",children:[e.jsx("p",{className:"text-muted-foreground text-sm font-medium mb-4",children:"Currency totals"}),e.jsxs("dl",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-baseline gap-2",children:[e.jsx("dt",{className:"text-muted-foreground text-sm",children:"Available value"}),e.jsx("dd",{className:"text-xl font-semibold tabular-nums",children:t.totals_by_currency&&Object.keys(t.totals_by_currency).length>0?_(t.totals_by_currency):"—"})]}),e.jsxs("div",{className:"flex justify-between items-baseline gap-2",children:[e.jsx("dt",{className:"text-muted-foreground text-sm",children:"Available for sale"}),e.jsx("dd",{className:"text-xl font-semibold tabular-nums",children:t.available_for_sale_by_currency&&Object.keys(t.available_for_sale_by_currency).length>0?_(t.available_for_sale_by_currency):"—"})]})]})]})})]}),e.jsxs(U,{children:[e.jsxs(ve,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium",children:"Assets in this category"}),e.jsxs("div",{className:"text-muted-foreground text-sm tabular-nums flex flex-wrap items-center gap-x-4 gap-y-1 mt-1",children:[t.available_assets_count!=null&&e.jsxs("span",{children:[t.available_assets_count," available item",t.available_assets_count!==1?"s":""]}),e.jsxs("span",{children:["Value: ",_(t.totals_by_currency)]}),(t.available_for_sale_count??0)>0&&e.jsxs("span",{className:"text-primary/90",children:[t.available_for_sale_count," for sale · ",_(t.available_for_sale_by_currency)]})]})]}),e.jsxs("form",{className:"flex items-center gap-2",onSubmit:s=>{s.preventDefault(),ge()},children:[e.jsx(we,{ref:Y,name:"search",placeholder:"Search in category...",defaultValue:a.search,className:"h-10 w-[180px] sm:w-[200px]"}),e.jsx(c,{type:"submit",variant:"secondary",size:"sm",className:"h-10 px-3",children:e.jsx(Se,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 pt-2 border-t",children:[e.jsx("span",{className:"text-muted-foreground text-sm mr-1",children:"View:"}),e.jsx(c,{variant:a.status==="all"||!a.status?"secondary":"outline",size:"sm",className:"h-8",onClick:()=>v("all"),children:"All"}),e.jsx(c,{variant:a.status==="available"?"secondary":"outline",size:"sm",className:"h-8",onClick:()=>v("available"),children:"Available"}),e.jsx(c,{variant:a.status==="available_for_sale"?"secondary":"outline",size:"sm",className:"h-8",onClick:()=>v("available_for_sale"),children:"Available for sale"}),e.jsx(c,{variant:a.status==="sold"?"secondary":"outline",size:"sm",className:"h-8",onClick:()=>v("sold"),children:"Sold"}),e.jsx(c,{variant:a.status==="in_use"?"secondary":"outline",size:"sm",className:"h-8",onClick:()=>v("in_use"),children:"In use"})]})]}),e.jsx(P,{children:o.data.length===0?e.jsx("p",{className:"py-8 text-center text-muted-foreground",children:"No assets in this category."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto rounded-md border",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-muted/50",children:[e.jsx("th",{className:"w-10 p-3",children:o.data.length>0&&e.jsx(Z,{checked:I,onCheckedChange:ie,"aria-label":"Select all on page"})}),e.jsx("th",{className:"p-3 text-left font-medium",children:e.jsxs("button",{type:"button",onClick:()=>w("name"),className:"inline-flex items-center gap-1 hover:text-foreground focus:outline-none focus:underline",children:["Name / Tag",p==="name"?h==="asc"?e.jsx(C,{className:"h-3.5 w-3.5"}):e.jsx(y,{className:"h-3.5 w-3.5"}):e.jsx(S,{className:"h-3.5 w-3.5 opacity-50"})]})}),e.jsx("th",{className:"p-3 text-left font-medium",children:e.jsxs("button",{type:"button",onClick:()=>w("status"),className:"inline-flex items-center gap-1 hover:text-foreground focus:outline-none focus:underline",children:["Status",p==="status"?h==="asc"?e.jsx(C,{className:"h-3.5 w-3.5"}):e.jsx(y,{className:"h-3.5 w-3.5"}):e.jsx(S,{className:"h-3.5 w-3.5 opacity-50"})]})}),e.jsx("th",{className:"p-3 text-left font-medium",children:e.jsxs("button",{type:"button",onClick:()=>w("assigned_to"),className:"inline-flex items-center gap-1 hover:text-foreground focus:outline-none focus:underline",children:["Assigned to",p==="assigned_to"?h==="asc"?e.jsx(C,{className:"h-3.5 w-3.5"}):e.jsx(y,{className:"h-3.5 w-3.5"}):e.jsx(S,{className:"h-3.5 w-3.5 opacity-50"})]})}),e.jsx("th",{className:"p-3 text-right font-medium",children:e.jsxs("button",{type:"button",onClick:()=>w("purchase_price"),className:"inline-flex items-center gap-1 hover:text-foreground focus:outline-none focus:underline ml-auto",children:["Value",p==="purchase_price"?h==="asc"?e.jsx(C,{className:"h-3.5 w-3.5"}):e.jsx(y,{className:"h-3.5 w-3.5"}):e.jsx(S,{className:"h-3.5 w-3.5 opacity-50"})]})}),e.jsx("th",{className:"w-20 p-3 text-right font-medium"})]})}),e.jsx("tbody",{children:o.data.map(s=>e.jsxs("tr",{className:"border-b last:border-0 hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"p-3",onClick:l=>l.stopPropagation(),children:e.jsx(Z,{checked:i.has(s.uuid),onCheckedChange:()=>ne(s.uuid),"aria-label":`Select ${s.name}`})}),e.jsxs("td",{className:"p-3",children:[e.jsx(x,{href:r.route("assets.show",{asset:s.uuid}),className:"font-medium text-primary hover:underline focus:outline-none focus:underline",children:s.name}),e.jsx("div",{className:"text-muted-foreground text-xs",children:s.asset_tag})]}),e.jsx("td",{className:"p-3",children:e.jsx(Ne,{status:s.status,label:W[s.status]})}),e.jsx("td",{className:"p-3",children:s.assigned_to_user?pe(s.assigned_to_user):"—"}),e.jsx("td",{className:"p-3 text-right tabular-nums",children:se(s.purchase_price,s.currency)}),e.jsx("td",{className:"p-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(c,{variant:"ghost",size:"icon",className:"h-8 w-8",asChild:!0,children:e.jsx(x,{href:r.route("assets.edit",{asset:s.uuid}),title:"Edit",children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsx(c,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive hover:text-destructive",title:"Delete",onClick:()=>T(s.uuid),children:e.jsx(Q,{className:"h-4 w-4"})})]})})]},s.id))})]})}),o.last_page>1&&e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Page ",o.current_page," of ",o.last_page," (",o.total," total)"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{variant:"outline",size:"sm",disabled:o.current_page<=1,asChild:!0,children:e.jsxs(x,{href:r.route("assets.categories.show",{category:t.id,page:o.current_page-1,search:a.search,status:a.status==="all"?void 0:a.status,sort:a.sort,dir:a.dir}),children:[e.jsx(ke,{className:"h-4 w-4"})," Previous"]})}),e.jsx(c,{variant:"outline",size:"sm",disabled:o.current_page>=o.last_page,asChild:!0,children:e.jsxs(x,{href:r.route("assets.categories.show",{category:t.id,page:o.current_page+1,search:a.search,status:a.status==="all"?void 0:a.status,sort:a.sort,dir:a.dir}),children:["Next ",e.jsx(Ae,{className:"h-4 w-4"})]})})]})]})]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx(x,{href:r.route("assets.categories.index"),children:"← Categories"})}),e.jsx(c,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(x,{href:r.route("assets.create"),children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"Add asset"]})})]})]})})]})}export{Us as default};
