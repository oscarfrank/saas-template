import{r as p,j as e,H as g,L as N}from"./app-BCbVRjYH.js";import{A as y}from"./app-layout-DDUYIrv9.js";import{B as a}from"./button-uRfG0SJk.js";import{C as x}from"./card-BD7iHYUQ.js";import{b as o}from"./utils-DawFQoOT.js";import{t as i}from"./index-DQu8XgdM.js";import{u as b}from"./use-tenant-router-DiYxGHG9.js";import{A as k}from"./arrow-left-BfZHK7-S.js";import{M as h}from"./message-square-1In2mIgy.js";import{S}from"./send-BZLN5_vp.js";/* empty css            */import"./breadcrumb-Kf_Jua1h.js";import"./input-CrGy8JR3.js";import"./sheet-BWAeJB6C.js";import"./index-DPt8kAZf.js";import"./index-D8qEZ9Gx.js";import"./index-BUJG5R3i.js";import"./index-yqb1x3RI.js";import"./index-CGjHmAMw.js";import"./index-BtBzczEp.js";import"./index-J5wWsuif.js";import"./x-D611PGoW.js";import"./createLucideIcon-GhyqP1ys.js";import"./index-oDWWD3I5.js";import"./index-CRLWXLw8.js";import"./index-BKQezIhM.js";import"./dropdown-menu-RgYEZTz0.js";import"./index-CsWEytiP.js";import"./index-B-AhuyaU.js";import"./check-B9bfcpBy.js";import"./chevron-down-RiCOlSmY.js";import"./skeleton-BmqfrkAd.js";import"./use-effective-tenant-CQ6us_Au.js";import"./trash-2-DpopIwP-.js";import"./en-US-DSSwd-Ay.js";import"./endOfMonth-BNqLjwTF.js";import"./user-B55N5piZ.js";import"./file-text-CFSx456Y.js";import"./dollar-sign-CPcgpTPL.js";import"./credit-card-BcosqvxM.js";import"./mail-hckPM3CY.js";import"./shield-DZlKfUFe.js";import"./circle-alert-DuZXvBOf.js";import"./package-DUGkiw1_.js";import"./users-69zSRrQI.js";import"./wallet-CbL3ywdH.js";import"./building-2-CxDNleOb.js";import"./chevron-right-BmqFOubz.js";import"./sonner-D7WukHuY.js";const w=[{title:"Admin",href:"/admin"},{title:"Tickets",href:"/admin/tickets"},{title:"View Ticket",href:"#"}];function ye({ticket:s}){var m,u;const r=b(),[l,n]=p.useState(""),[c,d]=p.useState(!1),f=t=>{if(t.preventDefault(),!l.trim()){i.error("Please enter a message");return}r.post("tickets.reply",{message:l,is_internal:c},{ticket:s.id},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{n(""),d(!1),i.success("Reply sent successfully")},onError:()=>{i.error("Failed to send reply")}})},j={open:"bg-blue-100 text-blue-800",in_progress:"bg-yellow-100 text-yellow-800",resolved:"bg-green-100 text-green-800",closed:"bg-gray-100 text-gray-800"},v={low:"bg-gray-100 text-gray-800",medium:"bg-blue-100 text-blue-800",high:"bg-yellow-100 text-yellow-800",urgent:"bg-red-100 text-red-800"};return e.jsxs(y,{breadcrumbs:w,children:[e.jsx(g,{title:`View Ticket - ${s.subject}`}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(N,{href:r.route("admin.tickets.index"),children:e.jsxs(a,{variant:"outline",className:"cursor-pointer",children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),"Back to Tickets"]})}),e.jsxs("div",{className:"flex gap-2",children:[s.status==="open"&&e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"outline",onClick:()=>r.put("tickets.update",{status:"in_progress"},{ticket:s.id},{preserveState:!0,preserveScroll:!0,onSuccess:()=>i.success("Ticket marked as in progress")}),children:"Mark as In Progress"}),e.jsx(a,{variant:"outline",onClick:()=>r.put("tickets.update",{status:"resolved"},{ticket:s.id},{preserveState:!0,preserveScroll:!0,onSuccess:()=>i.success("Ticket marked as resolved")}),children:"Mark as Resolved"}),e.jsx(a,{variant:"outline",onClick:()=>r.put("tickets.update",{status:"closed"},{ticket:s.id},{preserveState:!0,preserveScroll:!0,onSuccess:()=>i.success("Ticket marked as closed")}),children:"Mark as Closed"})]}),s.status==="in_progress"&&e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"outline",onClick:()=>r.put("tickets.update",{status:"open"},{ticket:s.id},{preserveState:!0,preserveScroll:!0,onSuccess:()=>i.success("Ticket reopened")}),children:"Reopen Ticket"}),e.jsx(a,{variant:"outline",onClick:()=>r.put("tickets.update",{status:"resolved"},{ticket:s.id},{preserveState:!0,preserveScroll:!0,onSuccess:()=>i.success("Ticket marked as resolved")}),children:"Mark as Resolved"}),e.jsx(a,{variant:"outline",onClick:()=>r.put("tickets.update",{status:"closed"},{ticket:s.id},{preserveState:!0,preserveScroll:!0,onSuccess:()=>i.success("Ticket marked as closed")}),children:"Mark as Closed"})]}),s.status==="resolved"&&e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"outline",onClick:()=>r.put("tickets.update",{status:"open"},{ticket:s.id},{preserveState:!0,preserveScroll:!0,onSuccess:()=>i.success("Ticket reopened")}),children:"Reopen Ticket"}),e.jsx(a,{variant:"outline",onClick:()=>r.put("tickets.update",{status:"closed"},{ticket:s.id},{preserveState:!0,preserveScroll:!0,onSuccess:()=>i.success("Ticket marked as closed")}),children:"Mark as Closed"})]}),s.status==="closed"&&e.jsx(a,{variant:"outline",onClick:()=>r.put("tickets.update",{status:"open"},{ticket:s.id},{preserveState:!0,preserveScroll:!0,onSuccess:()=>i.success("Ticket reopened")}),children:"Reopen Ticket"}),e.jsx(a,{variant:"destructive",onClick:()=>{confirm("Are you sure you want to delete this ticket?")&&r.delete("tickets.destroy",{ticket:s.id},{preserveState:!0,onSuccess:()=>{i.success("Ticket deleted successfully"),r.visit("admin.tickets.index")}})},children:"Delete Ticket"})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:s.subject}),e.jsx("p",{className:"text-muted-foreground",children:"Ticket Details"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Description"}),e.jsx("p",{className:"text-muted-foreground",children:s.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${j[s.status]}`,children:s.status.replace("_"," ")}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${v[s.priority]}`,children:s.priority}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:s.category})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Created By"}),e.jsxs("p",{className:"text-muted-foreground",children:[s.user.first_name," ",s.user.last_name]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Assigned To"}),e.jsxs("p",{className:"text-muted-foreground",children:[(m=s.assignedTo)==null?void 0:m.first_name," ",((u=s.assignedTo)==null?void 0:u.last_name)||"Unassigned"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Created At"}),e.jsx("p",{className:"text-muted-foreground",children:o(s.created_at)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Last Reply"}),e.jsx("p",{className:"text-muted-foreground",children:s.last_reply_at?o(s.last_reply_at):"No replies"})]})]})]})}),e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col h-[600px]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Conversation"}),e.jsx("p",{className:"text-muted-foreground",children:"Ticket replies and updates"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(a,{variant:"outline",size:"sm",onClick:()=>{var t;return(t=document.getElementById("reply-form"))==null?void 0:t.scrollIntoView({behavior:"smooth"})},children:[e.jsx(h,{className:"h-4 w-4 mr-2"}),"Add Reply"]})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto pr-4",children:s.replies.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(h,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No replies yet. Be the first to respond!"})]}):e.jsx("div",{className:"space-y-6",children:s.replies.map(t=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-primary",children:t.user.first_name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[t.user.first_name," ",t.user.last_name]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o(t.created_at)})]})]}),t.is_internal&&e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:"Internal Note"})]}),e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"text-muted-foreground whitespace-pre-wrap",children:t.message})})]},t.id))})}),e.jsx("div",{id:"reply-form",className:"border-t pt-6 mt-4",children:s.status!=="resolved"&&s.status!=="closed"?e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Add a Reply"}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Message"}),e.jsx("textarea",{id:"message",value:l,onChange:t=>n(t.target.value),placeholder:"Type your reply here...",className:"w-full rounded-lg border p-4 focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-[150px]",rows:4})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"internal",checked:c,onChange:t=>d(t.target.checked),className:"mr-2"}),e.jsx("label",{htmlFor:"internal",className:"text-sm text-muted-foreground",children:"Internal Note (only visible to staff)"})]}),e.jsxs(a,{type:"submit",disabled:!l.trim(),children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Send Reply"]})]})]})]}):e.jsx("div",{className:"text-center py-8",children:e.jsxs("p",{className:"text-muted-foreground",children:["This ticket has been ",s.status,". Reopen the ticket to add more replies."]})})})]})})]})]})]})}export{ye as default};
