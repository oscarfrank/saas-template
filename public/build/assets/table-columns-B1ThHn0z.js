import{j as e,L as m,r as h}from"./app-AYk_vs9E.js";import{u as g}from"./use-tenant-router-yHxY6vf2.js";import{B as D}from"./button-DttS-hSO.js";import{D as S,a as y,b as v,e as w,c as t,d as x}from"./dropdown-menu-C44z3VEl.js";import{t as o}from"./index-BSCeWBGl.js";import{f as _}from"./utils-DawFQoOT.js";import{C as N}from"./custom-alert-dialog-hVS-5wDI.js";import{B as k}from"./badge-CZj20M3O.js";import{E as L}from"./ellipsis-D73LBEFI.js";import{C as A}from"./copy-D8gkrNRg.js";import{S as E}from"./share-2-Cs2z7e5H.js";import{E as F}from"./eye-Bhjc1mcq.js";import{P as R}from"./pencil-DsGzSekW.js";import{C as V}from"./circle-check-Bz38sZpv.js";import{C as H}from"./circle-x-C9q9AgMZ.js";import{D as K}from"./dollar-sign-CtwrfOoy.js";import{C as M}from"./circle-check-big-B4mDpyuM.js";import{F as T}from"./file-text-DJz8nwxt.js";import{C as I}from"./circle-alert-DSmqB_aB.js";import{T as B}from"./trash-2-CBlWZpKk.js";/* empty css            */import"./index-C6YWzjxw.js";import"./index-DpFxWXhO.js";import"./index-BS1oCJ0R.js";import"./index-DH27nmtP.js";import"./index-DB97fau_.js";import"./index-KBPR2gxA.js";import"./index-D-MPqe8D.js";import"./index-JB8FLK9q.js";import"./index-kZDZBK9R.js";import"./index-DVPqwmDN.js";import"./check-o4IyhQhV.js";import"./createLucideIcon-B8-QgQ2g.js";const $=s=>({pending:"bg-yellow-500",approved:"bg-blue-500",rejected:"bg-red-500",active:"bg-green-500",in_arrears:"bg-orange-500",defaulted:"bg-red-600",paid:"bg-green-600",cancelled:"bg-red-400"})[s]||"bg-gray-500",O=s=>["pending_approval"].includes(s),P=s=>["pending_approval","approved"].includes(s),U=s=>["approved"].includes(s),X=s=>["active","in_arrears"].includes(s),q=s=>["paid","defaulted"].includes(s),z=s=>["draft","pending_approval","approved"].includes(s),Ne=({onDelete:s})=>[{id:"reference_number",accessorKey:"reference_number",header:"Reference",enableSorting:!0,enableHiding:!0,cell:({row:a})=>{const r=a.original,l=g();return e.jsx(m,{href:l.route("loans.show",{loan:r.id}),className:"font-medium hover:underline cursor-pointer",children:a.getValue("reference_number")})}},{id:"user",accessorFn:a=>`${a.user.first_name} ${a.user.last_name}`,header:"Borrower",enableSorting:!0},{id:"amount",accessorKey:"amount",header:"Amount",enableSorting:!0,enableHiding:!0,cell:({row:a})=>{const r=parseFloat(a.getValue("amount")),l=a.original.currency.code;return e.jsx("div",{className:"font-medium",children:_(r,l)})}},{id:"status",accessorKey:"status",header:"Status",enableSorting:!0,enableHiding:!0,cell:({row:a})=>{const r=a.getValue("status");return e.jsx(k,{className:`${$(r)} text-white`,children:r.replace("_"," ").toUpperCase()})}},{id:"interest_rate",accessorKey:"interest_rate",header:"Interest Rate",enableSorting:!0,enableHiding:!0,cell:({row:a})=>{const r=parseFloat(a.getValue("interest_rate"));return e.jsxs("div",{children:[r.toFixed(2),"%"]})}},{id:"duration_days",accessorKey:"duration_days",header:"Duration",enableSorting:!0,enableHiding:!0,cell:({row:a})=>{const r=a.getValue("duration_days");return e.jsxs("div",{children:[r," days"]})}},{id:"start_date",accessorKey:"start_date",header:"Start Date",enableSorting:!0,enableHiding:!0,cell:({row:a})=>{const r=a.getValue("start_date");return e.jsx("div",{children:r?new Date(r).toLocaleDateString():"N/A"})}},{id:"end_date",accessorKey:"end_date",header:"End Date",enableSorting:!0,enableHiding:!0,cell:({row:a})=>{const r=a.getValue("end_date");return e.jsx("div",{children:r?new Date(r).toLocaleDateString():"N/A"})}},{id:"created_at",accessorKey:"created_at",header:"Created At",enableSorting:!0,enableHiding:!0,cell:({row:a})=>e.jsx("div",{children:new Date(a.getValue("created_at")).toLocaleDateString()})},{id:"actions",cell:({row:a})=>{const r=a.original,[l,d]=h.useState(!1),[f,c]=h.useState(!1),n=g(),j=()=>{navigator.clipboard.writeText(String(r.id)),o.success("Loan ID copied to clipboard")},b=()=>{const u=n.route("loans.show",{loan:r.id});navigator.clipboard.writeText(u),o.success("Loan URL copied to clipboard")},C=()=>{c(!0),n.delete("loans.destroy",{loan:r.id},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{o.success("Loan deleted successfully"),d(!1),n.reload({only:["loans","pagination"],onSuccess:()=>{c(!1)},onError:()=>{c(!1),o.error("Failed to refresh data after deletion")}})},onError:()=>{c(!1),o.error("Failed to delete loan")}})},i=(u,p)=>{n.put("loans.update-status",{status:u},{id:r.id},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{o.success(`Loan ${p} successfully`),n.reload({only:["loans","pagination"]})},onError:()=>{o.error(`Failed to ${p} loan`)}})};return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(S,{children:[e.jsx(y,{asChild:!0,children:e.jsxs(D,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(L,{className:"h-4 w-4"})]})}),e.jsxs(v,{align:"end",children:[e.jsx(w,{children:"Actions"}),e.jsxs(t,{onClick:j,children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),"Copy ID"]}),e.jsxs(t,{onClick:b,children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),"Share"]}),e.jsx(x,{}),e.jsx(t,{asChild:!0,children:e.jsxs(m,{href:n.route("loans.show",{loan:r.id}),children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),"View"]})}),e.jsx(t,{asChild:!0,children:e.jsxs(m,{href:n.route("loans.edit",{loan:r.id}),children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Edit"]})}),O(r.status)&&e.jsxs(t,{onClick:()=>i("approved","approve"),children:[e.jsx(V,{className:"mr-2 h-4 w-4"}),"Approve"]}),P(r.status)&&e.jsxs(t,{onClick:()=>i("rejected","reject"),children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),"Reject"]}),U(r.status)&&e.jsxs(t,{onClick:()=>i("active","disburse"),children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"Disburse"]}),X(r.status)&&e.jsxs(t,{onClick:()=>i("paid","mark as paid"),children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),"Mark as Paid"]}),q(r.status)&&e.jsxs(t,{onClick:()=>i("closed","close"),children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),"Close"]}),z(r.status)&&e.jsxs(t,{onClick:()=>i("cancelled","cancel"),children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"Cancel"]}),e.jsx(x,{}),e.jsxs(t,{onClick:()=>d(!0),children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]}),e.jsx(N,{isOpen:l,onClose:()=>d(!1),onConfirm:C,title:"Delete Loan",description:`Are you sure you want to delete loan "${r.reference_number}"? This action cannot be undone.`,isLoading:f})]})}}];export{Ne as createColumns};
